<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>24 Model building | R for Data Science: Exercise Solutions</title>
  <meta name="description" content="Solutions to the exercises in “R for Data Science” by Garrett Grolemund and Hadley Wickham.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="24 Model building | R for Data Science: Exercise Solutions" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="http://jrnold.github.io/r4ds-exercise-solutions" />
  <meta property="og:image" content="http://jrnold.github.io/r4ds-exercise-solutions/img/cover.png" />
  <meta property="og:description" content="Solutions to the exercises in “R for Data Science” by Garrett Grolemund and Hadley Wickham." />
  <meta name="github-repo" content="jrnold/r4ds-exercise-solutions" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="24 Model building | R for Data Science: Exercise Solutions" />
  <meta name="twitter:site" content="@jrnld" />
  <meta name="twitter:description" content="Solutions to the exercises in “R for Data Science” by Garrett Grolemund and Hadley Wickham." />
  <meta name="twitter:image" content="http://jrnold.github.io/r4ds-exercise-solutions/img/cover.png" />

<meta name="author" content="Jeffrey B. Arnold">


<meta name="date" content="2019-01-11">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="model-basics.html">
<link rel="next" href="many-models.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<script src="libs/viz-0.3/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.0/grViz.js"></script>
<link href="libs/str_view-0.1.0/str_view.css" rel="stylesheet" />
<script src="libs/str_view-binding-1.3.1/str_view.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-61453123-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-61453123-2');
</script>
<!--
License: MIT License
Copyright (c) 2016 Open Review Toolkit & Ben Marwick

See https://github.com/benmarwick/bookdown-ort/blob/master/hypothesis.html
-->

<script async defer src="https://hypothes.is/embed.js"></script>
<script>window.hypothesisConfig = function () { return {showHighlights: false}; };</script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="includes/r4ds.css" type="text/css" />
<link rel="stylesheet" href="includes/r4ds-solutions.css" type="text/css" />
<link rel="stylesheet" href="includes/ort.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">R for Data Science:<br>Exercise Solutions</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#how-this-book-is-organized"><i class="fa fa-check"></i>How this book is organized</a></li>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#prerequisites"><i class="fa fa-check"></i><b>1.1</b> Prerequisites</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#bugscontributing"><i class="fa fa-check"></i>Bugs/Contributing</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#colophon"><i class="fa fa-check"></i>Colophon</a></li>
</ul></li>
<li class="part"><span><b>I Explore</b></span></li>
<li class="chapter" data-level="2" data-path="explore-intro.html"><a href="explore-intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a></li>
<li class="chapter" data-level="3" data-path="data-visualisation.html"><a href="data-visualisation.html"><i class="fa fa-check"></i><b>3</b> Data Visualisation</a><ul>
<li class="chapter" data-level="3.1" data-path="data-visualisation.html"><a href="data-visualisation.html#introduction-1"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="data-visualisation.html"><a href="data-visualisation.html#first-steps"><i class="fa fa-check"></i><b>3.2</b> First Steps</a><ul>
<li><a href="data-visualisation.html#exercise-3.2.1.">Exercise <span class="exercise-number">3.2.1</span>.</a></li>
<li><a href="data-visualisation.html#exercise-3.2.2.">Exercise <span class="exercise-number">3.2.2</span>.</a></li>
<li><a href="data-visualisation.html#exercise-3.2.3.">Exercise <span class="exercise-number">3.2.3</span>.</a></li>
<li><a href="data-visualisation.html#exercise-3.2.4.">Exercise <span class="exercise-number">3.2.4</span>.</a></li>
<li><a href="data-visualisation.html#exercise-3.2.5.">Exercise <span class="exercise-number">3.2.5</span>.</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="data-visualisation.html"><a href="data-visualisation.html#aesthetic-mappings"><i class="fa fa-check"></i><b>3.3</b> Aesthetic mappings</a><ul>
<li><a href="data-visualisation.html#exercise-3.3.1">Exercise <span class="exercise-number">3.3.1</span></a></li>
<li><a href="data-visualisation.html#exercise-3.3.2">Exercise <span class="exercise-number">3.3.2</span></a></li>
<li><a href="data-visualisation.html#exercise-3.3.3">Exercise <span class="exercise-number">3.3.3</span></a></li>
<li><a href="data-visualisation.html#exercise-3.3.4">Exercise <span class="exercise-number">3.3.4</span></a></li>
<li><a href="data-visualisation.html#exercise-3.3.5">Exercise <span class="exercise-number">3.3.5</span></a></li>
<li><a href="data-visualisation.html#exercise-3.3.6.">Exercise <span class="exercise-number">3.3.6</span>.</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="data-visualisation.html"><a href="data-visualisation.html#common-problems"><i class="fa fa-check"></i><b>3.4</b> Common problems</a></li>
<li class="chapter" data-level="3.5" data-path="data-visualisation.html"><a href="data-visualisation.html#facets"><i class="fa fa-check"></i><b>3.5</b> Facets</a><ul>
<li><a href="data-visualisation.html#exercise-3.5.1">Exercise <span class="exercise-number">3.5.1</span></a></li>
<li><a href="data-visualisation.html#exercise-3.5.2">Exercise <span class="exercise-number">3.5.2</span></a></li>
<li><a href="data-visualisation.html#exercise-3.5.3">Exercise <span class="exercise-number">3.5.3</span></a></li>
<li><a href="data-visualisation.html#exercise-3.5.4">Exercise <span class="exercise-number">3.5.4</span></a></li>
<li><a href="data-visualisation.html#exercise-3.5.5">Exercise <span class="exercise-number">3.5.5</span></a></li>
<li><a href="data-visualisation.html#exercise-3.5.6">Exercise <span class="exercise-number">3.5.6</span></a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="data-visualisation.html"><a href="data-visualisation.html#geometric-objects"><i class="fa fa-check"></i><b>3.6</b> Geometric Objects</a><ul>
<li><a href="data-visualisation.html#exercise-3.6.1">Exercise <span class="exercise-number">3.6.1</span></a></li>
<li><a href="data-visualisation.html#exercise-3.6.2">Exercise <span class="exercise-number">3.6.2</span></a></li>
<li><a href="data-visualisation.html#exercise-3.6.3">Exercise <span class="exercise-number">3.6.3</span></a></li>
<li><a href="data-visualisation.html#exercise-3.6.4">Exercise <span class="exercise-number">3.6.4</span></a></li>
<li><a href="data-visualisation.html#exercise-3.6.5">Exercise <span class="exercise-number">3.6.5</span></a></li>
<li><a href="data-visualisation.html#exercise-3.6.6">Exercise <span class="exercise-number">3.6.6</span></a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="data-visualisation.html"><a href="data-visualisation.html#statistical-transformations"><i class="fa fa-check"></i><b>3.7</b> Statistical Transformations</a><ul>
<li><a href="data-visualisation.html#exercise-3.1">Exercise <span class="exercise-number">3.1</span></a></li>
<li><a href="data-visualisation.html#exercise-3.2.">Exercise <span class="exercise-number">3.2</span>.</a></li>
<li><a href="data-visualisation.html#exercise-3.3.">Exercise <span class="exercise-number">3.3</span>.</a></li>
<li><a href="data-visualisation.html#exercise-3.4.">Exercise <span class="exercise-number">3.4</span>.</a></li>
<li><a href="data-visualisation.html#exercise-3.5.">Exercise <span class="exercise-number">3.5</span>.</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="data-visualisation.html"><a href="data-visualisation.html#position-adjustments"><i class="fa fa-check"></i><b>3.8</b> Position Adjustments</a><ul>
<li><a href="data-visualisation.html#exercise-3.8.1.">Exercise <span class="exercise-number">3.8.1</span>.</a></li>
<li><a href="data-visualisation.html#exercise-3.8.2.">Exercise <span class="exercise-number">3.8.2</span>.</a></li>
<li><a href="data-visualisation.html#exercise-3.8.3.">Exercise <span class="exercise-number">3.8.3</span>.</a></li>
<li><a href="data-visualisation.html#exercise-3.8.4.">Exercise <span class="exercise-number">3.8.4</span>.</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="data-visualisation.html"><a href="data-visualisation.html#coordinate-systems"><i class="fa fa-check"></i><b>3.9</b> Coordinate Systems</a><ul>
<li><a href="data-visualisation.html#exercise-3.9.1">Exercise <span class="exercise-number">3.9.1</span></a></li>
<li><a href="data-visualisation.html#exercise-3.9.2">Exercise <span class="exercise-number">3.9.2</span></a></li>
<li><a href="data-visualisation.html#exercise-3.9.3">Exercise <span class="exercise-number">3.9.3</span></a></li>
<li><a href="data-visualisation.html#exercise-3.9.4">Exercise <span class="exercise-number">3.9.4</span></a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="data-visualisation.html"><a href="data-visualisation.html#the-layered-grammar-of-graphics"><i class="fa fa-check"></i><b>3.10</b> The Layered Grammar of Graphics</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="workflow-basics.html"><a href="workflow-basics.html"><i class="fa fa-check"></i><b>4</b> Workflow: basics</a><ul>
<li class="chapter" data-level="" data-path="workflow-basics.html"><a href="workflow-basics.html#prerequisites-1"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="4.1" data-path="workflow-basics.html"><a href="workflow-basics.html#coding-basics"><i class="fa fa-check"></i><b>4.1</b> Coding basics</a></li>
<li class="chapter" data-level="4.2" data-path="workflow-basics.html"><a href="workflow-basics.html#whats-in-a-name"><i class="fa fa-check"></i><b>4.2</b> What’s in a name?</a></li>
<li class="chapter" data-level="4.3" data-path="workflow-basics.html"><a href="workflow-basics.html#calling-functions"><i class="fa fa-check"></i><b>4.3</b> Calling functions</a></li>
<li class="chapter" data-level="4.4" data-path="workflow-basics.html"><a href="workflow-basics.html#practice"><i class="fa fa-check"></i><b>4.4</b> Practice</a><ul>
<li><a href="workflow-basics.html#exercise-4.1">Exercise <span class="exercise-number">4.1</span></a></li>
<li><a href="workflow-basics.html#exercise-4.2">Exercise <span class="exercise-number">4.2</span></a></li>
<li><a href="workflow-basics.html#exercise-4.3">Exercise <span class="exercise-number">4.3</span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-transformation.html"><a href="data-transformation.html"><i class="fa fa-check"></i><b>5</b> Data transformation</a><ul>
<li class="chapter" data-level="5.1" data-path="data-transformation.html"><a href="data-transformation.html#introduction-2"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="data-transformation.html"><a href="data-transformation.html#filter-rows-with-filter"><i class="fa fa-check"></i><b>5.2</b> Filter rows with <code>filter()</code></a><ul>
<li><a href="data-transformation.html#exercise-5.2.1">Exercise <span class="exercise-number">5.2.1</span></a></li>
<li><a href="data-transformation.html#exercise-5.2.2">Exercise <span class="exercise-number">5.2.2</span></a></li>
<li><a href="data-transformation.html#exercise-5.2.3">Exercise <span class="exercise-number">5.2.3</span></a></li>
<li><a href="data-transformation.html#exercise-5.2.4">Exercise <span class="exercise-number">5.2.4</span></a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="data-transformation.html"><a href="data-transformation.html#arrange-rows-with-arrange"><i class="fa fa-check"></i><b>5.3</b> Arrange rows with <code>arrange()</code></a><ul>
<li><a href="data-transformation.html#exercise-5.3.1">Exercise <span class="exercise-number">5.3.1</span></a></li>
<li><a href="data-transformation.html#exercise-5.3.2">Exercise <span class="exercise-number">5.3.2</span></a></li>
<li><a href="data-transformation.html#exercise-5.3.3">Exercise <span class="exercise-number">5.3.3</span></a></li>
<li><a href="data-transformation.html#exercise-5.3.4">Exercise <span class="exercise-number">5.3.4</span></a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="data-transformation.html"><a href="data-transformation.html#select-columns-with-select"><i class="fa fa-check"></i><b>5.4</b> Select columns with <code>select()</code></a><ul>
<li><a href="data-transformation.html#exercise-5.4.1">Exercise <span class="exercise-number">5.4.1</span></a></li>
<li><a href="data-transformation.html#exercise-5.4.2">Exercise <span class="exercise-number">5.4.2</span></a></li>
<li><a href="data-transformation.html#exercise-5.4.3">Exercise <span class="exercise-number">5.4.3</span></a></li>
<li><a href="data-transformation.html#exercise-5.4.4">Exercise <span class="exercise-number">5.4.4</span></a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="data-transformation.html"><a href="data-transformation.html#add-new-variables-with-mutate"><i class="fa fa-check"></i><b>5.5</b> Add new variables with <code>mutate()</code></a><ul>
<li><a href="data-transformation.html#exercise-5.5.1">Exercise <span class="exercise-number">5.5.1</span></a></li>
<li><a href="data-transformation.html#exercise-5.5.2">Exercise <span class="exercise-number">5.5.2</span></a></li>
<li><a href="data-transformation.html#exercise-5.5.3">Exercise <span class="exercise-number">5.5.3</span></a></li>
<li><a href="data-transformation.html#exercise-5.5.4">Exercise <span class="exercise-number">5.5.4</span></a></li>
<li><a href="data-transformation.html#exercise-5.5.5">Exercise <span class="exercise-number">5.5.5</span></a></li>
<li><a href="data-transformation.html#exercise-5.5.6">Exercise <span class="exercise-number">5.5.6</span></a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="data-transformation.html"><a href="data-transformation.html#grouped-summaries-with-summarise"><i class="fa fa-check"></i><b>5.6</b> Grouped summaries with <code>summarise()</code></a><ul>
<li><a href="data-transformation.html#exercise-5.6.1">Exercise <span class="exercise-number">5.6.1</span></a></li>
<li><a href="data-transformation.html#exercise-5.6.2">Exercise <span class="exercise-number">5.6.2</span></a></li>
<li><a href="data-transformation.html#exercise-5.6.3">Exercise <span class="exercise-number">5.6.3</span></a></li>
<li><a href="data-transformation.html#exercise-5.6.4">Exercise <span class="exercise-number">5.6.4</span></a></li>
<li><a href="data-transformation.html#exercise-5.6.5">Exercise <span class="exercise-number">5.6.5</span></a></li>
<li><a href="data-transformation.html#exercise-5.6.6">Exercise <span class="exercise-number">5.6.6</span></a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="data-transformation.html"><a href="data-transformation.html#grouped-mutates-and-filters"><i class="fa fa-check"></i><b>5.7</b> Grouped mutates (and filters)</a><ul>
<li><a href="data-transformation.html#exercise-5.7.1">Exercise <span class="exercise-number">5.7.1</span></a></li>
<li><a href="data-transformation.html#exercise-5.7.2">Exercise <span class="exercise-number">5.7.2</span></a></li>
<li><a href="data-transformation.html#exercise-5.7.3">Exercise <span class="exercise-number">5.7.3</span></a></li>
<li><a href="data-transformation.html#exercise-5.7.4">Exercise <span class="exercise-number">5.7.4</span></a></li>
<li><a href="data-transformation.html#exercise-5.7.5">Exercise <span class="exercise-number">5.7.5</span></a></li>
<li><a href="data-transformation.html#exercise-5.7.6">Exercise <span class="exercise-number">5.7.6</span></a></li>
<li><a href="data-transformation.html#exercise-5.7.7">Exercise <span class="exercise-number">5.7.7</span></a></li>
<li><a href="data-transformation.html#exercise-5.7.8">Exercise <span class="exercise-number">5.7.8</span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="workflow-scripts.html"><a href="workflow-scripts.html"><i class="fa fa-check"></i><b>6</b> Workflow: scripts</a><ul>
<li class="chapter" data-level="6.1" data-path="workflow-scripts.html"><a href="workflow-scripts.html#running-code"><i class="fa fa-check"></i><b>6.1</b> Running code</a></li>
<li class="chapter" data-level="6.2" data-path="workflow-scripts.html"><a href="workflow-scripts.html#rstudio-diagnostics"><i class="fa fa-check"></i><b>6.2</b> RStudio diagnostics</a></li>
<li class="chapter" data-level="6.3" data-path="workflow-scripts.html"><a href="workflow-scripts.html#practice-1"><i class="fa fa-check"></i><b>6.3</b> Practice</a><ul>
<li><a href="workflow-scripts.html#exercise-6.1">Exercise <span class="exercise-number">6.1</span></a></li>
<li><a href="workflow-scripts.html#exercise-6.2">Exercise <span class="exercise-number">6.2</span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html"><i class="fa fa-check"></i><b>7</b> Exploratory Data Analysis</a><ul>
<li class="chapter" data-level="7.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#introduction-3"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#questions"><i class="fa fa-check"></i><b>7.2</b> Questions</a></li>
<li class="chapter" data-level="7.3" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#variation"><i class="fa fa-check"></i><b>7.3</b> Variation</a><ul>
<li><a href="exploratory-data-analysis.html#exercise-7.3.1">Exercise <span class="exercise-number">7.3.1</span></a></li>
<li><a href="exploratory-data-analysis.html#exercise-7.3.2">Exercise <span class="exercise-number">7.3.2</span></a></li>
<li><a href="exploratory-data-analysis.html#exercise-7.3.3">Exercise <span class="exercise-number">7.3.3</span></a></li>
<li><a href="exploratory-data-analysis.html#exercise-7.3.4">Exercise <span class="exercise-number">7.3.4</span></a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#missing-values"><i class="fa fa-check"></i><b>7.4</b> Missing Values</a><ul>
<li><a href="exploratory-data-analysis.html#exercise-7.4.1">Exercise <span class="exercise-number">7.4.1</span></a></li>
<li><a href="exploratory-data-analysis.html#exercise-7.4.2">Exercise <span class="exercise-number">7.4.2</span></a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#covariation"><i class="fa fa-check"></i><b>7.5</b> Covariation</a><ul>
<li class="chapter" data-level="7.5.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#a-categorical-and-continuous-variable"><i class="fa fa-check"></i><b>7.5.1</b> A categorical and continuous variable</a></li>
<li class="chapter" data-level="7.5.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#two-categorical-variables"><i class="fa fa-check"></i><b>7.5.2</b> Two categorical variables</a></li>
<li class="chapter" data-level="7.5.3" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#two-continuous-variables"><i class="fa fa-check"></i><b>7.5.3</b> Two continuous variables</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#patterns-and-models"><i class="fa fa-check"></i><b>7.6</b> Patterns and models</a></li>
<li class="chapter" data-level="7.7" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#ggplot2-calls"><i class="fa fa-check"></i><b>7.7</b> ggplot2 calls</a></li>
<li class="chapter" data-level="7.8" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#learning-more"><i class="fa fa-check"></i><b>7.8</b> Learning more</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="workflow-projects.html"><a href="workflow-projects.html"><i class="fa fa-check"></i><b>8</b> Workflow: projects</a></li>
<li class="part"><span><b>II Wrangle</b></span></li>
<li class="chapter" data-level="9" data-path="introduction-4.html"><a href="introduction-4.html"><i class="fa fa-check"></i><b>9</b> Introduction</a></li>
<li class="chapter" data-level="10" data-path="tibbles.html"><a href="tibbles.html"><i class="fa fa-check"></i><b>10</b> Tibbles</a><ul>
<li class="chapter" data-level="10.1" data-path="tibbles.html"><a href="tibbles.html#introduction-5"><i class="fa fa-check"></i><b>10.1</b> Introduction</a></li>
<li class="chapter" data-level="10.2" data-path="tibbles.html"><a href="tibbles.html#creating-tibbles"><i class="fa fa-check"></i><b>10.2</b> Creating Tibbles</a></li>
<li class="chapter" data-level="10.3" data-path="tibbles.html"><a href="tibbles.html#tibbles-vs.data.frame"><i class="fa fa-check"></i><b>10.3</b> Tibbles vs. data.frame</a></li>
<li class="chapter" data-level="10.4" data-path="tibbles.html"><a href="tibbles.html#subsetting"><i class="fa fa-check"></i><b>10.4</b> Subsetting</a></li>
<li class="chapter" data-level="10.5" data-path="tibbles.html"><a href="tibbles.html#interacting-with-older-code"><i class="fa fa-check"></i><b>10.5</b> Interacting with older code</a></li>
<li class="chapter" data-level="10.6" data-path="tibbles.html"><a href="tibbles.html#exercises"><i class="fa fa-check"></i><b>10.6</b> Exercises</a><ul>
<li><a href="tibbles.html#exercise-10.1">Exercise <span class="exercise-number">10.1</span></a></li>
<li><a href="tibbles.html#exercise-10.2">Exercise <span class="exercise-number">10.2</span></a></li>
<li><a href="tibbles.html#exercise-10.3">Exercise <span class="exercise-number">10.3</span></a></li>
<li><a href="tibbles.html#exercise-10.4">Exercise <span class="exercise-number">10.4</span></a></li>
<li><a href="tibbles.html#exercise-10.5">Exercise <span class="exercise-number">10.5</span></a></li>
<li><a href="tibbles.html#exercise-10.6">Exercise <span class="exercise-number">10.6</span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="data-import.html"><a href="data-import.html"><i class="fa fa-check"></i><b>11</b> Data import</a><ul>
<li class="chapter" data-level="11.1" data-path="data-import.html"><a href="data-import.html#introduction-6"><i class="fa fa-check"></i><b>11.1</b> Introduction</a></li>
<li class="chapter" data-level="11.2" data-path="data-import.html"><a href="data-import.html#getting-started"><i class="fa fa-check"></i><b>11.2</b> Getting started</a><ul>
<li><a href="data-import.html#exercise-11.2.1">Exercise <span class="exercise-number">11.2.1</span></a></li>
<li><a href="data-import.html#exercise-11.2.2">Exercise <span class="exercise-number">11.2.2</span></a></li>
<li><a href="data-import.html#exercise-11.2.3">Exercise <span class="exercise-number">11.2.3</span></a></li>
<li><a href="data-import.html#exercise-11.2.4">Exercise <span class="exercise-number">11.2.4</span></a></li>
<li><a href="data-import.html#exercise-11.2.5">Exercise <span class="exercise-number">11.2.5</span></a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="data-import.html"><a href="data-import.html#parsing-a-vector"><i class="fa fa-check"></i><b>11.3</b> Parsing a vector</a><ul>
<li><a href="data-import.html#exercise-11.3.1">Exercise <span class="exercise-number">11.3.1</span></a></li>
<li><a href="data-import.html#exercise-11.3.2">Exercise <span class="exercise-number">11.3.2</span></a></li>
<li><a href="data-import.html#exercise-11.3.3">Exercise <span class="exercise-number">11.3.3</span></a></li>
<li><a href="data-import.html#exercise-11.3.4">Exercise <span class="exercise-number">11.3.4</span></a></li>
<li><a href="data-import.html#exercise-11.3.5">Exercise <span class="exercise-number">11.3.5</span></a></li>
<li><a href="data-import.html#exercise-11.3.6">Exercise <span class="exercise-number">11.3.6</span></a></li>
<li><a href="data-import.html#exercise-11.3.7">Exercise <span class="exercise-number">11.3.7</span></a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="data-import.html"><a href="data-import.html#parsing-a-file"><i class="fa fa-check"></i><b>11.4</b> Parsing a file</a></li>
<li class="chapter" data-level="11.5" data-path="data-import.html"><a href="data-import.html#writing-to-a-file"><i class="fa fa-check"></i><b>11.5</b> Writing to a file</a></li>
<li class="chapter" data-level="11.6" data-path="data-import.html"><a href="data-import.html#other-types-of-data"><i class="fa fa-check"></i><b>11.6</b> Other Types of Data</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="tidy-data.html"><a href="tidy-data.html"><i class="fa fa-check"></i><b>12</b> Tidy Data</a><ul>
<li class="chapter" data-level="12.1" data-path="tidy-data.html"><a href="tidy-data.html#introduction-7"><i class="fa fa-check"></i><b>12.1</b> Introduction</a></li>
<li class="chapter" data-level="12.2" data-path="tidy-data.html"><a href="tidy-data.html#tidy-data-1"><i class="fa fa-check"></i><b>12.2</b> Tidy data</a><ul>
<li><a href="tidy-data.html#exercise-12.2.1">Exercise <span class="exercise-number">12.2.1</span></a></li>
<li><a href="tidy-data.html#exercise-12.2.2">Exercise <span class="exercise-number">12.2.2</span></a></li>
<li><a href="tidy-data.html#exercise-12.2.3">Exercise <span class="exercise-number">12.2.3</span></a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="tidy-data.html"><a href="tidy-data.html#spreading-and-gathering"><i class="fa fa-check"></i><b>12.3</b> Spreading and Gathering</a><ul>
<li><a href="tidy-data.html#exercise-12.3.1">Exercise <span class="exercise-number">12.3.1</span></a></li>
<li><a href="tidy-data.html#exercise-12.3.2">Exercise <span class="exercise-number">12.3.2</span></a></li>
<li><a href="tidy-data.html#exercise-12.3.3">Exercise <span class="exercise-number">12.3.3</span></a></li>
<li><a href="tidy-data.html#exercise-12.3.4">Exercise <span class="exercise-number">12.3.4</span></a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="tidy-data.html"><a href="tidy-data.html#separating-and-uniting"><i class="fa fa-check"></i><b>12.4</b> Separating and Uniting</a><ul>
<li><a href="tidy-data.html#exercise-12.4.1">Exercise <span class="exercise-number">12.4.1</span></a></li>
<li><a href="tidy-data.html#exercise-12.4.2">Exercise <span class="exercise-number">12.4.2</span></a></li>
<li><a href="tidy-data.html#exercise-12.4.3">Exercise <span class="exercise-number">12.4.3</span></a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="tidy-data.html"><a href="tidy-data.html#missing-values-1"><i class="fa fa-check"></i><b>12.5</b> Missing Values</a><ul>
<li><a href="tidy-data.html#exercise-12.5.1">Exercise <span class="exercise-number">12.5.1</span></a></li>
<li><a href="tidy-data.html#exercise-12.5.2">Exercise <span class="exercise-number">12.5.2</span></a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="tidy-data.html"><a href="tidy-data.html#case-study"><i class="fa fa-check"></i><b>12.6</b> Case Study</a><ul>
<li><a href="tidy-data.html#exercise-12.6.1">Exercise <span class="exercise-number">12.6.1</span></a></li>
<li><a href="tidy-data.html#exercise-12.6.2">Exercise <span class="exercise-number">12.6.2</span></a></li>
<li><a href="tidy-data.html#exercise-12.6.3">Exercise <span class="exercise-number">12.6.3</span></a></li>
<li><a href="tidy-data.html#exercise-12.6.4">Exercise <span class="exercise-number">12.6.4</span></a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="tidy-data.html"><a href="tidy-data.html#non-tidy-data"><i class="fa fa-check"></i><b>12.7</b> Non-Tidy Data</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="relational-data.html"><a href="relational-data.html"><i class="fa fa-check"></i><b>13</b> Relational data</a><ul>
<li class="chapter" data-level="13.1" data-path="relational-data.html"><a href="relational-data.html#introduction-8"><i class="fa fa-check"></i><b>13.1</b> Introduction</a></li>
<li class="chapter" data-level="13.2" data-path="relational-data.html"><a href="relational-data.html#nycflights13"><i class="fa fa-check"></i><b>13.2</b> nycflights13</a><ul>
<li><a href="relational-data.html#exercise-13.2.1">Exercise <span class="exercise-number">13.2.1</span></a></li>
<li><a href="relational-data.html#exercise-13.2.2">Exercise <span class="exercise-number">13.2.2</span></a></li>
<li><a href="relational-data.html#exercise-13.2.3">Exercise <span class="exercise-number">13.2.3</span></a></li>
<li><a href="relational-data.html#exercise-13.2.4">Exercise <span class="exercise-number">13.2.4</span></a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="relational-data.html"><a href="relational-data.html#keys"><i class="fa fa-check"></i><b>13.3</b> Keys</a><ul>
<li><a href="relational-data.html#exercise-13.3.1">Exercise <span class="exercise-number">13.3.1</span></a></li>
<li><a href="relational-data.html#exercise-13.3.2">Exercise <span class="exercise-number">13.3.2</span></a></li>
<li><a href="relational-data.html#exercise-13.3.3">Exercise <span class="exercise-number">13.3.3</span></a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="relational-data.html"><a href="relational-data.html#mutating-joins"><i class="fa fa-check"></i><b>13.4</b> Mutating Joins</a><ul>
<li><a href="relational-data.html#exercise-13.4.1">Exercise <span class="exercise-number">13.4.1</span></a></li>
<li><a href="relational-data.html#exercise-13.4.2">Exercise <span class="exercise-number">13.4.2</span></a></li>
<li><a href="relational-data.html#exercise-13.4.3">Exercise <span class="exercise-number">13.4.3</span></a></li>
<li><a href="relational-data.html#exercise-13.4.4">Exercise <span class="exercise-number">13.4.4</span></a></li>
<li><a href="relational-data.html#exercise-13.4.5">Exercise <span class="exercise-number">13.4.5</span></a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="relational-data.html"><a href="relational-data.html#filtering-joins"><i class="fa fa-check"></i><b>13.5</b> Filtering Joins</a><ul>
<li><a href="relational-data.html#exercise-13.5.1">Exercise <span class="exercise-number">13.5.1</span></a></li>
<li><a href="relational-data.html#exercise-13.5.2">Exercise <span class="exercise-number">13.5.2</span></a></li>
<li><a href="relational-data.html#exercise-13.5.3">Exercise <span class="exercise-number">13.5.3</span></a></li>
<li><a href="relational-data.html#exercise-13.5.4">Exercise <span class="exercise-number">13.5.4</span></a></li>
<li><a href="relational-data.html#exercise-13.5.5">Exercise <span class="exercise-number">13.5.5</span></a></li>
<li><a href="relational-data.html#exercise-13.5.6">Exercise <span class="exercise-number">13.5.6</span></a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="relational-data.html"><a href="relational-data.html#join-problems"><i class="fa fa-check"></i><b>13.6</b> Join problems</a></li>
<li class="chapter" data-level="13.7" data-path="relational-data.html"><a href="relational-data.html#set-operations"><i class="fa fa-check"></i><b>13.7</b> Set operations</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="strings.html"><a href="strings.html"><i class="fa fa-check"></i><b>14</b> Strings</a><ul>
<li class="chapter" data-level="14.1" data-path="strings.html"><a href="strings.html#introduction-9"><i class="fa fa-check"></i><b>14.1</b> Introduction</a></li>
<li class="chapter" data-level="14.2" data-path="strings.html"><a href="strings.html#string-basics"><i class="fa fa-check"></i><b>14.2</b> String Basics</a><ul>
<li><a href="strings.html#exercise-14.2.1">Exercise <span class="exercise-number">14.2.1</span></a></li>
<li><a href="strings.html#exercise-14.2.2">Exercise <span class="exercise-number">14.2.2</span></a></li>
<li><a href="strings.html#exercise-14.2.3">Exercise <span class="exercise-number">14.2.3</span></a></li>
<li><a href="strings.html#exercise-14.2.4">Exercise <span class="exercise-number">14.2.4</span></a></li>
<li><a href="strings.html#exercise-14.2.5">Exercise <span class="exercise-number">14.2.5</span></a></li>
<li><a href="strings.html#exercise-14.2.6">Exercise <span class="exercise-number">14.2.6</span></a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="strings.html"><a href="strings.html#matching-patterns-and-regular-expressions"><i class="fa fa-check"></i><b>14.3</b> Matching Patterns and Regular Expressions</a><ul>
<li class="chapter" data-level="14.3.1" data-path="strings.html"><a href="strings.html#basic-matches"><i class="fa fa-check"></i><b>14.3.1</b> Basic Matches</a></li>
<li class="chapter" data-level="14.3.2" data-path="strings.html"><a href="strings.html#anchors"><i class="fa fa-check"></i><b>14.3.2</b> Anchors</a></li>
<li class="chapter" data-level="14.3.3" data-path="strings.html"><a href="strings.html#character-classes-and-alternatives"><i class="fa fa-check"></i><b>14.3.3</b> Character classes and alternatives</a></li>
<li class="chapter" data-level="14.3.4" data-path="strings.html"><a href="strings.html#repetition"><i class="fa fa-check"></i><b>14.3.4</b> Repetition</a></li>
<li class="chapter" data-level="14.3.5" data-path="strings.html"><a href="strings.html#grouping-and-backreferences"><i class="fa fa-check"></i><b>14.3.5</b> Grouping and backreferences</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="strings.html"><a href="strings.html#tools"><i class="fa fa-check"></i><b>14.4</b> Tools</a><ul>
<li class="chapter" data-level="14.4.1" data-path="strings.html"><a href="strings.html#detect-matches"><i class="fa fa-check"></i><b>14.4.1</b> Detect matches</a></li>
<li class="chapter" data-level="14.4.2" data-path="strings.html"><a href="strings.html#extract-matches"><i class="fa fa-check"></i><b>14.4.2</b> Extract Matches</a></li>
<li class="chapter" data-level="14.4.3" data-path="strings.html"><a href="strings.html#grouped-matches"><i class="fa fa-check"></i><b>14.4.3</b> Grouped Matches</a></li>
<li class="chapter" data-level="14.4.4" data-path="strings.html"><a href="strings.html#replacing-matches"><i class="fa fa-check"></i><b>14.4.4</b> Replacing Matches</a></li>
<li class="chapter" data-level="14.4.5" data-path="strings.html"><a href="strings.html#splitting"><i class="fa fa-check"></i><b>14.4.5</b> Splitting</a></li>
<li class="chapter" data-level="14.4.6" data-path="strings.html"><a href="strings.html#find-matches"><i class="fa fa-check"></i><b>14.4.6</b> Find matches</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="strings.html"><a href="strings.html#other-types-of-patterns"><i class="fa fa-check"></i><b>14.5</b> Other types of patterns</a><ul>
<li><a href="strings.html#exercise-14.5.1">Exercise <span class="exercise-number">14.5.1</span></a></li>
<li><a href="strings.html#exercise-14.5.2">Exercise <span class="exercise-number">14.5.2</span></a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="strings.html"><a href="strings.html#other-uses-of-regular-expressions"><i class="fa fa-check"></i><b>14.6</b> Other uses of regular expressions</a></li>
<li class="chapter" data-level="14.7" data-path="strings.html"><a href="strings.html#stringi"><i class="fa fa-check"></i><b>14.7</b> stringi</a><ul>
<li><a href="strings.html#exercise-14.7.1">Exercise <span class="exercise-number">14.7.1</span></a></li>
<li><a href="strings.html#exercise-14.7.2">Exercise <span class="exercise-number">14.7.2</span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="factors.html"><a href="factors.html"><i class="fa fa-check"></i><b>15</b> Factors</a><ul>
<li class="chapter" data-level="15.1" data-path="factors.html"><a href="factors.html#introduction-10"><i class="fa fa-check"></i><b>15.1</b> Introduction</a></li>
<li class="chapter" data-level="15.2" data-path="factors.html"><a href="factors.html#creating-factors"><i class="fa fa-check"></i><b>15.2</b> Creating Factors</a></li>
<li class="chapter" data-level="15.3" data-path="factors.html"><a href="factors.html#general-social-survey"><i class="fa fa-check"></i><b>15.3</b> General Social Survey</a><ul>
<li><a href="factors.html#exercise-15.3.1">Exercise <span class="exercise-number">15.3.1</span></a></li>
<li><a href="factors.html#exercise-15.3.2">Exercise <span class="exercise-number">15.3.2</span></a></li>
<li><a href="factors.html#exercise-15.3.3">Exercise <span class="exercise-number">15.3.3</span></a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="factors.html"><a href="factors.html#modifying-factor-order"><i class="fa fa-check"></i><b>15.4</b> Modifying factor order</a><ul>
<li><a href="factors.html#exercise-15.4.1">Exercise <span class="exercise-number">15.4.1</span></a></li>
<li><a href="factors.html#exercise-15.4.2">Exercise <span class="exercise-number">15.4.2</span></a></li>
<li><a href="factors.html#exercise-15.4.3">Exercise <span class="exercise-number">15.4.3</span></a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="factors.html"><a href="factors.html#modifying-factor-levels"><i class="fa fa-check"></i><b>15.5</b> Modifying factor levels</a><ul>
<li><a href="factors.html#exercise-15.5.1">Exercise <span class="exercise-number">15.5.1</span></a></li>
<li><a href="factors.html#exercise-15.5.2">Exercise <span class="exercise-number">15.5.2</span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="dates-and-times.html"><a href="dates-and-times.html"><i class="fa fa-check"></i><b>16</b> Dates and times</a><ul>
<li class="chapter" data-level="16.1" data-path="dates-and-times.html"><a href="dates-and-times.html#introduction-11"><i class="fa fa-check"></i><b>16.1</b> Introduction</a></li>
<li class="chapter" data-level="16.2" data-path="dates-and-times.html"><a href="dates-and-times.html#creating-datetimes"><i class="fa fa-check"></i><b>16.2</b> Creating date/times</a><ul>
<li><a href="dates-and-times.html#exercise-16.2.1">Exercise <span class="exercise-number">16.2.1</span></a></li>
<li><a href="dates-and-times.html#exercise-16.2.2">Exercise <span class="exercise-number">16.2.2</span></a></li>
<li><a href="dates-and-times.html#exercise-16.2.3">Exercise <span class="exercise-number">16.2.3</span></a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="dates-and-times.html"><a href="dates-and-times.html#date-time-components"><i class="fa fa-check"></i><b>16.3</b> Date-Time Components</a><ul>
<li><a href="dates-and-times.html#exercise-16.3.1">Exercise <span class="exercise-number">16.3.1</span></a></li>
<li><a href="dates-and-times.html#exercise-16.3.2">Exercise <span class="exercise-number">16.3.2</span></a></li>
<li><a href="dates-and-times.html#exercise-16.3.3">Exercise <span class="exercise-number">16.3.3</span></a></li>
<li><a href="dates-and-times.html#exercise-16.3.4">Exercise <span class="exercise-number">16.3.4</span></a></li>
<li><a href="dates-and-times.html#exercise-16.3.5">Exercise <span class="exercise-number">16.3.5</span></a></li>
<li><a href="dates-and-times.html#exercise-16.3.6">Exercise <span class="exercise-number">16.3.6</span></a></li>
<li><a href="dates-and-times.html#exercise-16.3.7">Exercise <span class="exercise-number">16.3.7</span></a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="dates-and-times.html"><a href="dates-and-times.html#time-spans"><i class="fa fa-check"></i><b>16.4</b> Time Spans</a><ul>
<li><a href="dates-and-times.html#exercise-16.4.1">Exercise <span class="exercise-number">16.4.1</span></a></li>
<li><a href="dates-and-times.html#exercise-16.4.2">Exercise <span class="exercise-number">16.4.2</span></a></li>
<li><a href="dates-and-times.html#exercise-16.4.3">Exercise <span class="exercise-number">16.4.3</span></a></li>
<li><a href="dates-and-times.html#exercise-16.4.4">Exercise <span class="exercise-number">16.4.4</span></a></li>
<li><a href="dates-and-times.html#exercise-16.4.5">Exercise <span class="exercise-number">16.4.5</span></a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="dates-and-times.html"><a href="dates-and-times.html#time-zones"><i class="fa fa-check"></i><b>16.5</b> Time Zones</a></li>
</ul></li>
<li class="part"><span><b>III Program</b></span></li>
<li class="chapter" data-level="17" data-path="program-intro.html"><a href="program-intro.html"><i class="fa fa-check"></i><b>17</b> Introduction</a></li>
<li class="chapter" data-level="18" data-path="pipes.html"><a href="pipes.html"><i class="fa fa-check"></i><b>18</b> Pipes</a></li>
<li class="chapter" data-level="19" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>19</b> Functions</a><ul>
<li class="chapter" data-level="19.1" data-path="functions.html"><a href="functions.html#introduction-12"><i class="fa fa-check"></i><b>19.1</b> Introduction</a></li>
<li class="chapter" data-level="19.2" data-path="functions.html"><a href="functions.html#when-should-you-write-a-function"><i class="fa fa-check"></i><b>19.2</b> When should you write a function?</a><ul>
<li><a href="functions.html#exercise-19.2.1">Exercise <span class="exercise-number">19.2.1</span></a></li>
<li><a href="functions.html#exercise-19.2.2">Exercise <span class="exercise-number">19.2.2</span></a></li>
<li><a href="functions.html#exercise-19.2.3">Exercise <span class="exercise-number">19.2.3</span></a></li>
<li><a href="functions.html#exercise-19.2.4">Exercise <span class="exercise-number">19.2.4</span></a></li>
<li><a href="functions.html#exercise-19.2.5">Exercise <span class="exercise-number">19.2.5</span></a></li>
<li><a href="functions.html#exercise-19.2.6">Exercise <span class="exercise-number">19.2.6</span></a></li>
<li><a href="functions.html#exercise-19.2.7">Exercise <span class="exercise-number">19.2.7</span></a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="functions.html"><a href="functions.html#functions-are-for-humans-and-computers"><i class="fa fa-check"></i><b>19.3</b> Functions are for humans and computers</a><ul>
<li><a href="functions.html#exercise-19.3.1">Exercise <span class="exercise-number">19.3.1</span></a></li>
<li><a href="functions.html#exercise-19.3.2">Exercise <span class="exercise-number">19.3.2</span></a></li>
<li><a href="functions.html#exercise-19.3.3">Exercise <span class="exercise-number">19.3.3</span></a></li>
<li><a href="functions.html#exercise-19.3.4">Exercise <span class="exercise-number">19.3.4</span></a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="functions.html"><a href="functions.html#conditional-execution"><i class="fa fa-check"></i><b>19.4</b> Conditional execution</a><ul>
<li><a href="functions.html#exercise-19.4.1">Exercise <span class="exercise-number">19.4.1</span></a></li>
<li><a href="functions.html#exercise-19.4.2">Exercise <span class="exercise-number">19.4.2</span></a></li>
<li><a href="functions.html#exercise-19.4.3">Exercise <span class="exercise-number">19.4.3</span></a></li>
<li><a href="functions.html#exercise-19.4.4">Exercise <span class="exercise-number">19.4.4</span></a></li>
<li><a href="functions.html#exercise-19.4.5">Exercise <span class="exercise-number">19.4.5</span></a></li>
<li><a href="functions.html#exercise-19.4.6">Exercise <span class="exercise-number">19.4.6</span></a></li>
</ul></li>
<li class="chapter" data-level="19.5" data-path="functions.html"><a href="functions.html#function-arguments"><i class="fa fa-check"></i><b>19.5</b> Function arguments</a><ul>
<li><a href="functions.html#exercise-19.5.1">Exercise <span class="exercise-number">19.5.1</span></a></li>
<li><a href="functions.html#exercise-19.5.2">Exercise <span class="exercise-number">19.5.2</span></a></li>
<li><a href="functions.html#exercise-19.5.3">Exercise <span class="exercise-number">19.5.3</span></a></li>
<li><a href="functions.html#exercise-19.5.4">Exercise <span class="exercise-number">19.5.4</span></a></li>
</ul></li>
<li class="chapter" data-level="19.6" data-path="functions.html"><a href="functions.html#return-values"><i class="fa fa-check"></i><b>19.6</b> Return values</a></li>
<li class="chapter" data-level="19.7" data-path="functions.html"><a href="functions.html#environment"><i class="fa fa-check"></i><b>19.7</b> Environment</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="vectors.html"><a href="vectors.html"><i class="fa fa-check"></i><b>20</b> Vectors</a><ul>
<li class="chapter" data-level="20.1" data-path="vectors.html"><a href="vectors.html#introduction-13"><i class="fa fa-check"></i><b>20.1</b> Introduction</a></li>
<li class="chapter" data-level="20.2" data-path="vectors.html"><a href="vectors.html#vector-basics"><i class="fa fa-check"></i><b>20.2</b> Vector Basics</a></li>
<li class="chapter" data-level="20.3" data-path="vectors.html"><a href="vectors.html#important-types-of-atomic-vector"><i class="fa fa-check"></i><b>20.3</b> Important Types of Atomic Vector</a><ul>
<li><a href="vectors.html#exercise-20.3.1">Exercise <span class="exercise-number">20.3.1</span></a></li>
<li><a href="vectors.html#exercise-20.3.2">Exercise <span class="exercise-number">20.3.2</span></a></li>
<li><a href="vectors.html#exercise-20.3.3">Exercise <span class="exercise-number">20.3.3</span></a></li>
<li><a href="vectors.html#exercise-20.3.4">Exercise <span class="exercise-number">20.3.4</span></a></li>
<li><a href="vectors.html#exercise-20.3.5">Exercise <span class="exercise-number">20.3.5</span></a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="vectors.html"><a href="vectors.html#using-atomic-vectors"><i class="fa fa-check"></i><b>20.4</b> Using atomic vectors</a><ul>
<li><a href="vectors.html#exercise-20.4.1">Exercise <span class="exercise-number">20.4.1</span></a></li>
<li><a href="vectors.html#exercise-20.4.2">Exercise <span class="exercise-number">20.4.2</span></a></li>
<li><a href="vectors.html#exercise-20.4.3">Exercise <span class="exercise-number">20.4.3</span></a></li>
<li><a href="vectors.html#exercise-20.4.4">Exercise <span class="exercise-number">20.4.4</span></a></li>
<li><a href="vectors.html#exercise-20.4.5">Exercise <span class="exercise-number">20.4.5</span></a></li>
<li><a href="vectors.html#exercise-20.4.6">Exercise <span class="exercise-number">20.4.6</span></a></li>
</ul></li>
<li class="chapter" data-level="20.5" data-path="vectors.html"><a href="vectors.html#recursive-vectors-lists"><i class="fa fa-check"></i><b>20.5</b> Recursive Vectors (lists)</a><ul>
<li><a href="vectors.html#exercise-20.5.1">Exercise <span class="exercise-number">20.5.1</span></a></li>
<li><a href="vectors.html#exercise-20.5.2">Exercise <span class="exercise-number">20.5.2</span></a></li>
</ul></li>
<li class="chapter" data-level="20.6" data-path="vectors.html"><a href="vectors.html#attributes"><i class="fa fa-check"></i><b>20.6</b> Attributes</a></li>
<li class="chapter" data-level="20.7" data-path="vectors.html"><a href="vectors.html#augmented-vectors"><i class="fa fa-check"></i><b>20.7</b> Augmented Vectors</a><ul>
<li><a href="vectors.html#exercise-20.7.1">Exercise <span class="exercise-number">20.7.1</span></a></li>
<li><a href="vectors.html#exercise-20.7.2">Exercise <span class="exercise-number">20.7.2</span></a></li>
<li><a href="vectors.html#exercise-20.7.3">Exercise <span class="exercise-number">20.7.3</span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="21" data-path="iteration.html"><a href="iteration.html"><i class="fa fa-check"></i><b>21</b> Iteration</a><ul>
<li class="chapter" data-level="21.1" data-path="iteration.html"><a href="iteration.html#introduction-14"><i class="fa fa-check"></i><b>21.1</b> Introduction</a></li>
<li class="chapter" data-level="21.2" data-path="iteration.html"><a href="iteration.html#for-loops"><i class="fa fa-check"></i><b>21.2</b> For Loops</a><ul>
<li><a href="iteration.html#exercise-21.2.1">Exercise <span class="exercise-number">21.2.1</span></a></li>
<li><a href="iteration.html#exercise-21.2.2">Exercise <span class="exercise-number">21.2.2</span></a></li>
<li><a href="iteration.html#exercise-21.2.3">Exercise <span class="exercise-number">21.2.3</span></a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="iteration.html"><a href="iteration.html#for-loop-variations"><i class="fa fa-check"></i><b>21.3</b> For loop variations</a><ul>
<li><a href="iteration.html#exercise-21.3.1">Exercise <span class="exercise-number">21.3.1</span></a></li>
<li><a href="iteration.html#exercise-21.3.2">Exercise <span class="exercise-number">21.3.2</span></a></li>
<li><a href="iteration.html#exercise-21.3.3">Exercise <span class="exercise-number">21.3.3</span></a></li>
<li><a href="iteration.html#exercise-21.3.4">Exercise <span class="exercise-number">21.3.4</span></a></li>
</ul></li>
<li class="chapter" data-level="21.4" data-path="iteration.html"><a href="iteration.html#for-loops-vs.functionals"><i class="fa fa-check"></i><b>21.4</b> For loops vs. functionals</a><ul>
<li><a href="iteration.html#exercise-21.4.1">Exercise <span class="exercise-number">21.4.1</span></a></li>
<li><a href="iteration.html#exercise-21.4.2">Exercise <span class="exercise-number">21.4.2</span></a></li>
</ul></li>
<li class="chapter" data-level="21.5" data-path="iteration.html"><a href="iteration.html#the-map-functions"><i class="fa fa-check"></i><b>21.5</b> The map functions</a><ul>
<li><a href="iteration.html#exercise-21.5.1">Exercise <span class="exercise-number">21.5.1</span></a></li>
<li><a href="iteration.html#exercise-21.5.2">Exercise <span class="exercise-number">21.5.2</span></a></li>
<li><a href="iteration.html#exercise-21.5.3">Exercise <span class="exercise-number">21.5.3</span></a></li>
<li><a href="iteration.html#exercise-21.5.4">Exercise <span class="exercise-number">21.5.4</span></a></li>
<li><a href="iteration.html#exercise-21.5.5">Exercise <span class="exercise-number">21.5.5</span></a></li>
</ul></li>
<li class="chapter" data-level="21.6" data-path="iteration.html"><a href="iteration.html#dealing-with-failure"><i class="fa fa-check"></i><b>21.6</b> Dealing with Failure</a></li>
<li class="chapter" data-level="21.7" data-path="iteration.html"><a href="iteration.html#mapping-over-multiple-arguments"><i class="fa fa-check"></i><b>21.7</b> Mapping over multiple arguments</a></li>
<li class="chapter" data-level="21.8" data-path="iteration.html"><a href="iteration.html#walk"><i class="fa fa-check"></i><b>21.8</b> Walk</a></li>
<li class="chapter" data-level="21.9" data-path="iteration.html"><a href="iteration.html#other-patterns-of-for-loops"><i class="fa fa-check"></i><b>21.9</b> Other patterns of for loops</a><ul>
<li><a href="iteration.html#exercise-21.9.1">Exercise <span class="exercise-number">21.9.1</span></a></li>
<li><a href="iteration.html#exercise-21.9.2">Exercise <span class="exercise-number">21.9.2</span></a></li>
<li><a href="iteration.html#exercise-21.9.3">Exercise <span class="exercise-number">21.9.3</span></a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Model</b></span></li>
<li class="chapter" data-level="22" data-path="model-intro.html"><a href="model-intro.html"><i class="fa fa-check"></i><b>22</b> Introduction</a></li>
<li class="chapter" data-level="23" data-path="model-basics.html"><a href="model-basics.html"><i class="fa fa-check"></i><b>23</b> Model basics</a><ul>
<li class="chapter" data-level="23.1" data-path="model-basics.html"><a href="model-basics.html#prerequisites-2"><i class="fa fa-check"></i><b>23.1</b> Prerequisites</a></li>
<li class="chapter" data-level="23.2" data-path="model-basics.html"><a href="model-basics.html#a-simple-model"><i class="fa fa-check"></i><b>23.2</b> A simple model</a><ul>
<li><a href="model-basics.html#exercise-23.2.1">Exercise <span class="exercise-number">23.2.1</span></a></li>
<li><a href="model-basics.html#exercise-23.2.2">Exercise <span class="exercise-number">23.2.2</span></a></li>
<li><a href="model-basics.html#exercise-23.2.3">Exercise <span class="exercise-number">23.2.3</span></a></li>
</ul></li>
<li class="chapter" data-level="23.3" data-path="model-basics.html"><a href="model-basics.html#visualizing-models"><i class="fa fa-check"></i><b>23.3</b> Visualizing Models</a><ul>
<li><a href="model-basics.html#exercise-23.3.1">Exercise <span class="exercise-number">23.3.1</span></a></li>
<li><a href="model-basics.html#exercise-23.3.2">Exercise <span class="exercise-number">23.3.2</span></a></li>
<li><a href="model-basics.html#exercise-23.3.3">Exercise <span class="exercise-number">23.3.3</span></a></li>
<li><a href="model-basics.html#exercise-23.3.4">Exercise <span class="exercise-number">23.3.4</span></a></li>
</ul></li>
<li class="chapter" data-level="23.4" data-path="model-basics.html"><a href="model-basics.html#formulas-and-model-families"><i class="fa fa-check"></i><b>23.4</b> Formulas and Model Families</a><ul>
<li><a href="model-basics.html#exercise-23.4.1">Exercise <span class="exercise-number">23.4.1</span></a></li>
<li><a href="model-basics.html#exercise-23.4.2">Exercise <span class="exercise-number">23.4.2</span></a></li>
<li><a href="model-basics.html#exercise-23.4.3">Exercise <span class="exercise-number">23.4.3</span></a></li>
<li><a href="model-basics.html#exercise-23.4.4">Exercise <span class="exercise-number">23.4.4</span></a></li>
</ul></li>
<li class="chapter" data-level="23.5" data-path="model-basics.html"><a href="model-basics.html#missing-values-2"><i class="fa fa-check"></i><b>23.5</b> Missing values</a></li>
<li class="chapter" data-level="23.6" data-path="model-basics.html"><a href="model-basics.html#other-model-families"><i class="fa fa-check"></i><b>23.6</b> Other model families</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="model-building.html"><a href="model-building.html"><i class="fa fa-check"></i><b>24</b> Model building</a><ul>
<li class="chapter" data-level="24.1" data-path="model-building.html"><a href="model-building.html#introduction-15"><i class="fa fa-check"></i><b>24.1</b> Introduction</a></li>
<li class="chapter" data-level="24.2" data-path="model-building.html"><a href="model-building.html#why-are-low-quality-diamonds-more-expensive"><i class="fa fa-check"></i><b>24.2</b> Why are low quality diamonds more expensive?</a><ul>
<li><a href="model-building.html#exercise-24.2.1">Exercise <span class="exercise-number">24.2.1</span></a></li>
<li><a href="model-building.html#exercise-24.2.2">Exercise <span class="exercise-number">24.2.2</span></a></li>
<li><a href="model-building.html#exercise-24.2.3">Exercise <span class="exercise-number">24.2.3</span></a></li>
<li><a href="model-building.html#exercise-24.2.4">Exercise <span class="exercise-number">24.2.4</span></a></li>
</ul></li>
<li class="chapter" data-level="24.3" data-path="model-building.html"><a href="model-building.html#what-affects-the-number-of-daily-flights"><i class="fa fa-check"></i><b>24.3</b> What affects the number of daily flights?</a><ul>
<li><a href="model-building.html#exercise-24.3.1">Exercise <span class="exercise-number">24.3.1</span></a></li>
<li><a href="model-building.html#exercise-24.3.2">Exercise <span class="exercise-number">24.3.2</span></a></li>
<li><a href="model-building.html#exercise-24.3.3">Exercise <span class="exercise-number">24.3.3</span></a></li>
<li><a href="model-building.html#exercise-24.3.4">Exercise <span class="exercise-number">24.3.4</span></a></li>
<li><a href="model-building.html#exercise-24.3.5">Exercise <span class="exercise-number">24.3.5</span></a></li>
<li><a href="model-building.html#exercise-24.3.6">Exercise <span class="exercise-number">24.3.6</span></a></li>
<li><a href="model-building.html#exercise-24.3.7">Exercise <span class="exercise-number">24.3.7</span></a></li>
<li><a href="model-building.html#exercise-24.3.8">Exercise <span class="exercise-number">24.3.8</span></a></li>
</ul></li>
<li class="chapter" data-level="24.4" data-path="model-building.html"><a href="model-building.html#learning-more-about-models"><i class="fa fa-check"></i><b>24.4</b> Learning more about models</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="many-models.html"><a href="many-models.html"><i class="fa fa-check"></i><b>25</b> Many models</a><ul>
<li class="chapter" data-level="25.1" data-path="many-models.html"><a href="many-models.html#introduction-16"><i class="fa fa-check"></i><b>25.1</b> Introduction</a></li>
<li class="chapter" data-level="25.2" data-path="many-models.html"><a href="many-models.html#gapminder"><i class="fa fa-check"></i><b>25.2</b> Gapminder</a><ul>
<li><a href="many-models.html#exercise-25.2.1">Exercise <span class="exercise-number">25.2.1</span></a></li>
<li><a href="many-models.html#exercise-25.2.2">Exercise <span class="exercise-number">25.2.2</span></a></li>
<li><a href="many-models.html#exercise-25.2.3">Exercise <span class="exercise-number">25.2.3</span></a></li>
</ul></li>
<li class="chapter" data-level="25.3" data-path="many-models.html"><a href="many-models.html#list-columns"><i class="fa fa-check"></i><b>25.3</b> List-columns</a></li>
<li class="chapter" data-level="25.4" data-path="many-models.html"><a href="many-models.html#creating-list-columns"><i class="fa fa-check"></i><b>25.4</b> Creating list-columns</a><ul>
<li><a href="many-models.html#exercise-25.4.1">Exercise <span class="exercise-number">25.4.1</span></a></li>
<li><a href="many-models.html#exercise-25.4.2">Exercise <span class="exercise-number">25.4.2</span></a></li>
<li><a href="many-models.html#exercise-25.4.3">Exercise <span class="exercise-number">25.4.3</span></a></li>
<li><a href="many-models.html#exercise-25.4.4">Exercise <span class="exercise-number">25.4.4</span></a></li>
</ul></li>
<li class="chapter" data-level="25.5" data-path="many-models.html"><a href="many-models.html#simplifying-list-columns"><i class="fa fa-check"></i><b>25.5</b> Simplifying list-columns</a><ul>
<li><a href="many-models.html#exercise-25.5.1">Exercise <span class="exercise-number">25.5.1</span></a></li>
<li><a href="many-models.html#exercise-25.5.2">Exercise <span class="exercise-number">25.5.2</span></a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>V Communicate</b></span></li>
<li class="chapter" data-level="26" data-path="communicate-intro.html"><a href="communicate-intro.html"><i class="fa fa-check"></i><b>26</b> Introduction</a></li>
<li class="chapter" data-level="27" data-path="r-markdown.html"><a href="r-markdown.html"><i class="fa fa-check"></i><b>27</b> R Markdown</a><ul>
<li class="chapter" data-level="27.1" data-path="r-markdown.html"><a href="r-markdown.html#introduction-17"><i class="fa fa-check"></i><b>27.1</b> Introduction</a></li>
<li class="chapter" data-level="27.2" data-path="r-markdown.html"><a href="r-markdown.html#r-markdown-basics"><i class="fa fa-check"></i><b>27.2</b> R Markdown Basics</a><ul>
<li><a href="r-markdown.html#exercise-27.2.1">Exercise <span class="exercise-number">27.2.1</span></a></li>
<li><a href="r-markdown.html#exercise-27.2.2">Exercise <span class="exercise-number">27.2.2</span></a></li>
<li><a href="r-markdown.html#exercise-27.2.3">Exercise <span class="exercise-number">27.2.3</span></a></li>
<li><a href="r-markdown.html#exercise-27.2.4">Exercise <span class="exercise-number">27.2.4</span></a></li>
</ul></li>
<li class="chapter" data-level="27.3" data-path="r-markdown.html"><a href="r-markdown.html#text-formatting-with-r-markdown"><i class="fa fa-check"></i><b>27.3</b> Text formatting with R Markdown</a><ul>
<li><a href="r-markdown.html#exercise-27.3.1">Exercise <span class="exercise-number">27.3.1</span></a></li>
<li><a href="r-markdown.html#exercise-27.3.2">Exercise <span class="exercise-number">27.3.2</span></a></li>
<li><a href="r-markdown.html#exercise-27.3.3">Exercise <span class="exercise-number">27.3.3</span></a></li>
</ul></li>
<li class="chapter" data-level="27.4" data-path="r-markdown.html"><a href="r-markdown.html#code-chunks"><i class="fa fa-check"></i><b>27.4</b> Code Chunks</a><ul>
<li><a href="r-markdown.html#exercise-27.4.1">Exercise <span class="exercise-number">27.4.1</span></a></li>
<li><a href="r-markdown.html#exercise-27.4.2">Exercise <span class="exercise-number">27.4.2</span></a></li>
<li><a href="r-markdown.html#exercise-27.4.3">Exercise <span class="exercise-number">27.4.3</span></a></li>
<li><a href="r-markdown.html#exercise-27.4.4">Exercise <span class="exercise-number">27.4.4</span></a></li>
</ul></li>
<li class="chapter" data-level="27.5" data-path="r-markdown.html"><a href="r-markdown.html#yaml-header"><i class="fa fa-check"></i><b>27.5</b> YAML header</a></li>
<li class="chapter" data-level="27.6" data-path="r-markdown.html"><a href="r-markdown.html#learning-more-1"><i class="fa fa-check"></i><b>27.6</b> Learning more</a></li>
</ul></li>
<li class="chapter" data-level="28" data-path="graphics-for-communication.html"><a href="graphics-for-communication.html"><i class="fa fa-check"></i><b>28</b> Graphics for communication</a><ul>
<li class="chapter" data-level="28.1" data-path="graphics-for-communication.html"><a href="graphics-for-communication.html#introduction-18"><i class="fa fa-check"></i><b>28.1</b> Introduction</a></li>
<li class="chapter" data-level="28.2" data-path="graphics-for-communication.html"><a href="graphics-for-communication.html#label"><i class="fa fa-check"></i><b>28.2</b> Label</a><ul>
<li><a href="graphics-for-communication.html#exercise-28.2.1">Exercise <span class="exercise-number">28.2.1</span></a></li>
<li><a href="graphics-for-communication.html#exercise-28.2.2">Exercise <span class="exercise-number">28.2.2</span></a></li>
<li><a href="graphics-for-communication.html#exercise-28.2.3">Exercise <span class="exercise-number">28.2.3</span></a></li>
</ul></li>
<li class="chapter" data-level="28.3" data-path="graphics-for-communication.html"><a href="graphics-for-communication.html#annotations"><i class="fa fa-check"></i><b>28.3</b> Annotations</a><ul>
<li><a href="graphics-for-communication.html#exercise-28.3.1">Exercise <span class="exercise-number">28.3.1</span></a></li>
<li><a href="graphics-for-communication.html#exercise-28.3.2">Exercise <span class="exercise-number">28.3.2</span></a></li>
<li><a href="graphics-for-communication.html#exercise-28.3.3">Exercise <span class="exercise-number">28.3.3</span></a></li>
<li><a href="graphics-for-communication.html#exercise-28.3.4">Exercise <span class="exercise-number">28.3.4</span></a></li>
<li><a href="graphics-for-communication.html#exercise-28.3.5">Exercise <span class="exercise-number">28.3.5</span></a></li>
</ul></li>
<li class="chapter" data-level="28.4" data-path="graphics-for-communication.html"><a href="graphics-for-communication.html#scales"><i class="fa fa-check"></i><b>28.4</b> Scales</a><ul>
<li><a href="graphics-for-communication.html#exercise-28.4.1">Exercise <span class="exercise-number">28.4.1</span></a></li>
<li><a href="graphics-for-communication.html#exercise-28.4.2">Exercise <span class="exercise-number">28.4.2</span></a></li>
<li><a href="graphics-for-communication.html#exercise-28.4.3">Exercise <span class="exercise-number">28.4.3</span></a></li>
<li><a href="graphics-for-communication.html#exercise-28.4.4">Exercise <span class="exercise-number">28.4.4</span></a></li>
</ul></li>
<li class="chapter" data-level="28.5" data-path="graphics-for-communication.html"><a href="graphics-for-communication.html#zooming"><i class="fa fa-check"></i><b>28.5</b> Zooming</a></li>
<li class="chapter" data-level="28.6" data-path="graphics-for-communication.html"><a href="graphics-for-communication.html#themes"><i class="fa fa-check"></i><b>28.6</b> Themes</a></li>
<li class="chapter" data-level="28.7" data-path="graphics-for-communication.html"><a href="graphics-for-communication.html#saving-your-plots"><i class="fa fa-check"></i><b>28.7</b> Saving your plots</a></li>
<li class="chapter" data-level="28.8" data-path="graphics-for-communication.html"><a href="graphics-for-communication.html#learning-more-2"><i class="fa fa-check"></i><b>28.8</b> Learning more</a></li>
</ul></li>
<li class="chapter" data-level="29" data-path="r-markdown-formats.html"><a href="r-markdown-formats.html"><i class="fa fa-check"></i><b>29</b> R Markdown formats</a></li>
<li class="chapter" data-level="30" data-path="r-markdown-workflow.html"><a href="r-markdown-workflow.html"><i class="fa fa-check"></i><b>30</b> R Markdown workflow</a></li>
<li class="divider"></li>
<a href="https://bookdown.org" target="https://bookdown.org/yihui/bookdown">Published with bookdown</a>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R for Data Science: Exercise Solutions</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div class="alert alert-info hints-alert">
  <div class="hints-icon">
    <i class="fa fa-comments-o"></i>
  </div>
  <div class='hints-container'>
    <b>I need your help!</b>
    <p>
    If you find any typos, errors, or places where the text may be improved, please let me know.
    The best ways to provide feedback are by GitHub or hypothes.is annotations.
    </p>

    <p>
      <i class="fa fa-github"></i>
      Opening an <a href="https://github.com/jrnold/r4ds-exercise-solutions/issues">issue</a> or submitting a <a href="https://github.com/jrnold/r4ds-exercise-solutions/pulls">pull request</a> on <a href="https://github.com/jrnold/r4ds-exercise-solutions">GitHub</a>
    </p>
    <p>
      <i class="h-icon-hypothesis-logo"></i>
      Adding an annotation using <a href="https://hypothes.is">hypothes.is</a>.
      To add an annotation, <span style="background-color: #3297FD; color: white">select some text</span> and then click the
      <i class="h-icon-annotate"></i> on the pop-up menu.
      To see the annotations of others, click the
      <i class="h-icon-chevron-left"></i>
      in the upper right-hand corner of the page.
    </p>
  </div>
</div>
<div id="model-building" class="section level1">
<h1><span class="header-section-number">24</span> Model building</h1>
<div id="introduction-15" class="section level2">
<h2><span class="header-section-number">24.1</span> Introduction</h2>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)
<span class="kw">library</span>(modelr)
<span class="kw">library</span>(lubridate)
<span class="kw">options</span>(<span class="dt">na.action =</span> na.warn)
<span class="kw">library</span>(broom)
<span class="kw">library</span>(nycflights13)</code></pre>
</div>
<div id="why-are-low-quality-diamonds-more-expensive" class="section level2">
<h2><span class="header-section-number">24.2</span> Why are low quality diamonds more expensive?</h2>
<p>This code appears in the section and is necessary for the exercises.</p>
<pre class="sourceCode r"><code class="sourceCode r">diamonds2 &lt;-<span class="st"> </span>diamonds <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(carat <span class="op">&lt;=</span><span class="st"> </span><span class="fl">2.5</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">lprice =</span> <span class="kw">log2</span>(price),
    <span class="dt">lcarat =</span> <span class="kw">log2</span>(carat)
  )

mod_diamond2 &lt;-<span class="st"> </span><span class="kw">lm</span>(lprice <span class="op">~</span><span class="st"> </span>lcarat <span class="op">+</span><span class="st"> </span>color <span class="op">+</span><span class="st"> </span>cut <span class="op">+</span><span class="st"> </span>clarity, <span class="dt">data =</span> diamonds2)

diamonds2 &lt;-<span class="st"> </span><span class="kw">add_residuals</span>(diamonds2, mod_diamond2, <span class="st">&quot;lresid2&quot;</span>)</code></pre>
<div id="exercise-24.2.1" class="section level3 unnumbered exercise">
<h3>Exercise <span class="exercise-number">24.2.1</span></h3>
<div class="question">
<p>In the plot of <code>lcarat</code> vs. <code>lprice</code>, there are some bright vertical strips.
What do they represent?</p>
</div>
<div class="answer">
<p>The distribution of diamonds has more diamonds at round or otherwise human-friendly numbers (fractions).</p>
</div>
</div>
<div id="exercise-24.2.2" class="section level3 unnumbered exercise">
<h3>Exercise <span class="exercise-number">24.2.2</span></h3>
<div class="question">
<p>If <code>log(price) = a_0 + a_1 * log(carat)</code>, what does that say about the relationship between <code>price</code> and <code>carat</code>?</p>
</div>
<div class="answer">
<p>I’ll answer this question by first showing an empirical estimating the regression.
Following the examples in the chapter, I use a base of 2 for the logarithm.</p>
<pre class="sourceCode r"><code class="sourceCode r">mod_log &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log2</span>(price) <span class="op">~</span><span class="st"> </span><span class="kw">log2</span>(carat), <span class="dt">data =</span> diamonds)
mod_log
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = log2(price) ~ log2(carat), data = diamonds)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt; (Intercept)  log2(carat)  </span>
<span class="co">#&gt;       12.19         1.68</span></code></pre>
<p>The estimated relationship between <code>carat</code> and <code>price</code> looks like this.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tibble</span>(<span class="dt">carat =</span> <span class="kw">seq</span>(<span class="fl">0.25</span>, <span class="dv">5</span>, <span class="dt">by =</span> <span class="fl">0.25</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">add_predictions</span>(mod_log) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> carat, <span class="dt">y =</span> <span class="dv">2</span><span class="op">^</span>pred)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;carat&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;price&quot;</span>)</code></pre>
<p><img src="model-building_files/figure-html/unnamed-chunk-5-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>The plot shows that the estimated relationship between <code>carat</code> and <code>price</code> is not linear.
The exact relationship in this model is if <span class="math inline">\(x\)</span> increases <span class="math inline">\(r\)</span> times, then <span class="math inline">\(y\)</span> increases <span class="math inline">\(r^{a_1}\)</span> times.
For example, a two times increase in <code>carat</code> is associated with the following increase in <code>price</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="dv">2</span><span class="op">^</span><span class="kw">coef</span>(mod_log)[<span class="dv">2</span>]
<span class="co">#&gt; log2(carat) </span>
<span class="co">#&gt;         3.2</span></code></pre>
<p>Let’s confirm this relationship by checking it for a few values of the <code>carat</code> variable.
Let’s Increase <code>carat</code> from 1 to 2.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="dv">2</span><span class="op">^</span>(<span class="kw">predict</span>(mod_log, <span class="dt">newdata =</span> <span class="kw">tibble</span>(<span class="dt">carat =</span> <span class="dv">2</span>)) <span class="op">-</span>
<span class="st">  </span><span class="kw">predict</span>(mod_log, <span class="dt">newdata =</span> <span class="kw">tibble</span>(<span class="dt">carat =</span> <span class="dv">1</span>)))
<span class="co">#&gt;   1 </span>
<span class="co">#&gt; 3.2</span></code></pre>
<p>Note that, since <code>predict()</code> predicts <code>log2(carat)</code> rather than <code>carat</code>, the prediction is exponentiated by 2.
Now let’s increase <code>carat</code> from 4 to 2.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="dv">2</span><span class="op">^</span>(<span class="kw">predict</span>(mod_log, <span class="dt">newdata =</span> <span class="kw">tibble</span>(<span class="dt">carat =</span> <span class="dv">4</span>)) <span class="op">-</span>
<span class="st">  </span><span class="kw">predict</span>(mod_log, <span class="dt">newdata =</span> <span class="kw">tibble</span>(<span class="dt">carat =</span> <span class="dv">2</span>)))
<span class="co">#&gt;   1 </span>
<span class="co">#&gt; 3.2</span></code></pre>
<p>Finally, let’s increase <code>carat</code> from 0.5 to 1.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="dv">2</span><span class="op">^</span>(<span class="kw">predict</span>(mod_log, <span class="dt">newdata =</span> <span class="kw">tibble</span>(<span class="dt">carat =</span> <span class="dv">1</span>)) <span class="op">-</span>
<span class="st">  </span><span class="kw">predict</span>(mod_log, <span class="dt">newdata =</span> <span class="kw">tibble</span>(<span class="dt">carat =</span> <span class="fl">0.5</span>)))
<span class="co">#&gt;   1 </span>
<span class="co">#&gt; 3.2</span></code></pre>
<p>All of these examples return the same value, <span class="math inline">\(2 ^ {a_1} = 3.2\)</span>.</p>
<p>So why is this?
Let’s ignore the names of the variables in this case and consider the equation:
<span class="math display">\[
\log_b y = a_0 + a_1 \log x
\]</span>
We want to understand how the difference in <span class="math inline">\(y\)</span> is related to the difference in <span class="math inline">\(x\)</span>.
Now, consider this equation at two different values <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_0\)</span>,
<span class="math display">\[
\log_b y_0 = a_0 + \log_b x_0 \\
\log_b y_1 = a_0 + \log_b y_1
\]</span>
What is the value of the difference, <span class="math inline">\(\log y_1 - \log y_0\)</span>?
<span class="math display">\[
\begin{aligned}[t]
\log_b(y_1) - \log_b(y_0) &amp;= (a_0 + a_1 \log_b x_1) - (a_0 + a_1 \log x_0) ,\\
&amp;= a_1 (\log_b x_1 - \log x_0) , \\
\log_b \left(\frac{y_1}{y_0} \right) &amp;= \log_b \left(\frac{x_1}{x_0} \right)^{a_1} , \\
\frac{y_1}{y_0} &amp;=  \left( \frac{x_1}{x_0} \right)^{a_1} .
\end{aligned}
\]</span>
Let <span class="math inline">\(s = y_1 / y_0\)</span> and <span class="math inline">\(r = x_1 / x_0\)</span>. Then,
<span class="math display">\[
s =  r^{a_1} \text{.}
\]</span>
In other words, an <span class="math inline">\(r\)</span> times increase in <span class="math inline">\(x\)</span>, is associated with a <span class="math inline">\(r^{a_1}\)</span> times increase in <span class="math inline">\(y\)</span>.
Note that this relationship does not depend on the base of the logarithm, <span class="math inline">\(b\)</span>.</p>
<p>There is another approximation that is commonly used when logarithms appear in regressions.</p>
<p>The first way to show this is using the approximation that <span class="math inline">\(x\)</span> is small, meaning that <span class="math inline">\(x \approx 0\)</span>,
<span class="math display">\[
\log (1 + x) \approx x
\]</span>
This approximation is the first order Taylor expansion of the function at <span class="math inline">\(x = 0\)</span>.
Now consider the relationship between the percent change in <span class="math inline">\(x\)</span> and the percent change in <span class="math inline">\(y\)</span>,
<span class="math display">\[
\begin{aligned}[t]
\log (y + \Delta y) - \log y &amp;= (\alpha + \beta \log (x + \Delta x)) - (\alpha + \beta x) \\
\log \left(\frac{y + \Delta y}{y} \right) &amp;=  \beta \log\left( \frac{x + \Delta x}{x} \right) \\
\log \left(1 + \frac{\Delta y}{y} \right) &amp;= \beta  \log\left( 1 + \frac{\Delta x}{x} \right) \\
\frac{\Delta y}{y} &amp;\approx \beta \left(\frac{\Delta x}{x} \right)
\end{aligned} 
\]</span>
Thus a 1% percentage change in <span class="math inline">\(x\)</span> is associated with a <span class="math inline">\(\beta\)</span> percent change in <span class="math inline">\(y\)</span>.</p>
<p>This relationship can also be derived by taking the derivative of <span class="math inline">\(\log y\)</span> with respect to <span class="math inline">\(x\)</span>.
First, rewrite the equation in terms of <span class="math inline">\(y\)</span>,
<span class="math display">\[
y = \exp(a_0 + a_1 \log(x))
\]</span>
Then differentiate <span class="math inline">\(y\)</span> with respect to <span class="math inline">\(x\)</span>,
<span class="math display">\[
\begin{aligned}[t]
dy &amp;= \exp(a_0 + a_1 \log x) \left(\frac{a_1}{x}\right) dx \\
&amp;= a_1 y \left(\frac{dx}{x} \right) \\
(dy / y) &amp;= a_1 (dx / x) \\
\%\Delta y &amp;= a_1\%\Delta x
\end{aligned}
\]</span></p>
</div>
</div>
<div id="exercise-24.2.3" class="section level3 unnumbered exercise">
<h3>Exercise <span class="exercise-number">24.2.3</span></h3>
<div class="question">
<p>Extract the diamonds that have very high and very low residuals. Is there anything unusual about these diamonds? Are the particularly bad or good, or do you think these are pricing errors?</p>
</div>
<div class="answer">
<p>The answer to this question is given in section <a href="https://r4ds.had.co.nz/model-building.html#a-more-complicated-model">24.2.2</a>.</p>
<pre class="sourceCode r"><code class="sourceCode r">diamonds2 <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">abs</span>(lresid2) <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">add_predictions</span>(mod_diamond2) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">pred =</span> <span class="kw">round</span>(<span class="dv">2</span><span class="op">^</span>pred)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(price, pred, carat<span class="op">:</span>table, x<span class="op">:</span>z) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">arrange</span>(price)
<span class="co">#&gt; # A tibble: 16 x 11</span>
<span class="co">#&gt;   price  pred carat cut     color clarity depth table     x     y     z</span>
<span class="co">#&gt;   &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;ord&gt;   &lt;ord&gt; &lt;ord&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1  1013   264  0.25 Fair    F     SI2      54.4    64  4.3   4.23  2.32</span>
<span class="co">#&gt; 2  1186   284  0.25 Premium G     SI2      59      60  5.33  5.28  3.12</span>
<span class="co">#&gt; 3  1186   284  0.25 Premium G     SI2      58.8    60  5.33  5.28  3.12</span>
<span class="co">#&gt; 4  1262  2644  1.03 Fair    E     I1       78.2    54  5.72  5.59  4.42</span>
<span class="co">#&gt; 5  1415   639  0.35 Fair    G     VS2      65.9    54  5.57  5.53  3.66</span>
<span class="co">#&gt; 6  1415   639  0.35 Fair    G     VS2      65.9    54  5.57  5.53  3.66</span>
<span class="co">#&gt; # … with 10 more rows</span></code></pre>
<p>I did not see anything too unusual. Do you?</p>
</div>
</div>
<div id="exercise-24.2.4" class="section level3 unnumbered exercise">
<h3>Exercise <span class="exercise-number">24.2.4</span></h3>
<div class="question">
<p>Does the final model, <code>mod_diamonds2</code>, do a good job of predicting diamond prices?
Would you trust it to tell you how much to spend if you were buying a diamond?</p>
</div>
<div class="answer">
<p>Section <a href="https://r4ds.had.co.nz/model-building.html#a-more-complicated-model">24.2.2</a> already provides part of the answer to this question.</p>
<p>We can plot the residuals of the model. There are some large outliers for
small carat sizes there are some large errors. In this model, a residual of 2
means that the true value was four times lower.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(diamonds2, <span class="kw">aes</span>(lcarat, lresid2)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hex</span>(<span class="dt">bins =</span> <span class="dv">50</span>)</code></pre>
<p><img src="model-building_files/figure-html/unnamed-chunk-11-1.png" width="70%" style="display: block; margin: auto;" /></p>
<pre class="sourceCode r"><code class="sourceCode r">lresid2_summary &lt;-<span class="st"> </span><span class="kw">summarise</span>(diamonds2,
  <span class="dt">rmse =</span> <span class="kw">sqrt</span>(<span class="kw">mean</span>(lresid2<span class="op">^</span><span class="dv">2</span>)),
  <span class="dt">mae =</span> <span class="kw">mean</span>(<span class="kw">abs</span>(lresid2)),
  <span class="dt">p025 =</span> <span class="kw">quantile</span>(lresid2, <span class="fl">0.025</span>),
  <span class="dt">p975 =</span> <span class="kw">quantile</span>(lresid2, <span class="fl">0.975</span>)
)
lresid2_summary
<span class="co">#&gt; # A tibble: 1 x 4</span>
<span class="co">#&gt;    rmse   mae   p025  p975</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1 0.192 0.149 -0.369 0.384</span></code></pre>
<p>While in some cases the model can be very wrong, overall the model seems to perform well.
The root mean squared error is 0.19 meaning that the
average error is about -14%.
Another summary statistics of errors is the mean absolute error (MAE), which is the
mean of the absolute values of the errors.
The MAE is 0.15, which is -11%.
Finally, 95% of the residuals are between -0.37 and
0.38, which correspond to 23—31.</p>
<p>Whether you think that this is a good model depends on factors outside the statistical model itself.
It will depend on the how the model is being used.
I have no idea how to price diamonds, so this would be useful to me in order to understand a reasonable price range for a diamond, so I don’t get ripped off.
However, if I were buying and selling diamonds as a business, I would probably require a better model.</p>
</div>
</div>
</div>
<div id="what-affects-the-number-of-daily-flights" class="section level2">
<h2><span class="header-section-number">24.3</span> What affects the number of daily flights?</h2>
<p>This code is copied from the book and needed for the exercises.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;nycflights13&quot;</span>)
daily &lt;-<span class="st"> </span>flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">date =</span> <span class="kw">make_date</span>(year, month, day)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(date) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">n =</span> <span class="kw">n</span>())
daily
<span class="co">#&gt; # A tibble: 365 x 2</span>
<span class="co">#&gt;   date           n</span>
<span class="co">#&gt;   &lt;date&gt;     &lt;int&gt;</span>
<span class="co">#&gt; 1 2013-01-01   842</span>
<span class="co">#&gt; 2 2013-01-02   943</span>
<span class="co">#&gt; 3 2013-01-03   914</span>
<span class="co">#&gt; 4 2013-01-04   915</span>
<span class="co">#&gt; 5 2013-01-05   720</span>
<span class="co">#&gt; 6 2013-01-06   832</span>
<span class="co">#&gt; # … with 359 more rows</span>

daily &lt;-<span class="st"> </span>daily <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">wday =</span> <span class="kw">wday</span>(date, <span class="dt">label =</span> <span class="ot">TRUE</span>))

term &lt;-<span class="st"> </span><span class="cf">function</span>(date) {
  <span class="kw">cut</span>(date,
    <span class="dt">breaks =</span> <span class="kw">ymd</span>(<span class="dv">20130101</span>, <span class="dv">20130605</span>, <span class="dv">20130825</span>, <span class="dv">20140101</span>),
    <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;spring&quot;</span>, <span class="st">&quot;summer&quot;</span>, <span class="st">&quot;fall&quot;</span>)
  )
}

daily &lt;-<span class="st"> </span>daily <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">term =</span> <span class="kw">term</span>(date))

mod &lt;-<span class="st"> </span><span class="kw">lm</span>(n <span class="op">~</span><span class="st"> </span>wday, <span class="dt">data =</span> daily)

daily &lt;-<span class="st"> </span>daily <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">add_residuals</span>(mod)

mod1 &lt;-<span class="st"> </span><span class="kw">lm</span>(n <span class="op">~</span><span class="st"> </span>wday, <span class="dt">data =</span> daily)
mod2 &lt;-<span class="st"> </span><span class="kw">lm</span>(n <span class="op">~</span><span class="st"> </span>wday <span class="op">*</span><span class="st"> </span>term, <span class="dt">data =</span> daily)</code></pre>
<div id="exercise-24.3.1" class="section level3 unnumbered exercise">
<h3>Exercise <span class="exercise-number">24.3.1</span></h3>
<div class="question">
<p>Use your Google sleuthing skills to brainstorm why there were fewer than expected flights on Jan 20, May 26, and Sep 1.
(Hint: they all have the same explanation.)
How would these days generalize to another year?</p>
</div>
<div class="answer">
<p>These are the Sundays before Monday holidays Martin Luther King Jr. Day, Memorial Day, and Labor Day.
For other years, use the dates of the holidays for those years—the third Monday of January for Martin Luther King Jr. Day, the last Monday of May for Memorial Day, and the first Monday in September for Labor Day.</p>
</div>
</div>
<div id="exercise-24.3.2" class="section level3 unnumbered exercise">
<h3>Exercise <span class="exercise-number">24.3.2</span></h3>
<div class="question">
<p>What do the three days with high positive residuals represent?
How would these days generalize to another year?</p>
</div>
<div class="answer">
<p>The top three days correspond to the Saturday after Thanksgiving (November 30th),
the Sunday after Thanksgiving (December 1st), and the Saturday after Christmas (December 28th).</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">top_n</span>(daily, <span class="dv">3</span>, resid)
<span class="co">#&gt; # A tibble: 3 x 5</span>
<span class="co">#&gt;   date           n wday  term  resid</span>
<span class="co">#&gt;   &lt;date&gt;     &lt;int&gt; &lt;ord&gt; &lt;fct&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1 2013-11-30   857 Sat   fall  112. </span>
<span class="co">#&gt; 2 2013-12-01   987 Sun   fall   95.5</span>
<span class="co">#&gt; 3 2013-12-28   814 Sat   fall   69.4</span></code></pre>
<p>We could generalize these to other years using the dates of those holidays on those
years.</p>
</div>
</div>
<div id="exercise-24.3.3" class="section level3 unnumbered exercise">
<h3>Exercise <span class="exercise-number">24.3.3</span></h3>
<div class="question">
<p>Create a new variable that splits the <code>wday</code> variable into terms, but only for Saturdays, i.e., it should have <code>Thurs</code>, <code>Fri</code>, but <code>Sat-summer</code>, <code>Sat-spring</code>, <code>Sat-fall</code>
How does this model compare with the model with every combination of <code>wday</code> and <code>term</code>?</p>
</div>
<div class="answer">
<p>I’ll use the function <code>case_when()</code> to do this, though there are other ways which it could be solved.</p>
<pre class="sourceCode r"><code class="sourceCode r">daily &lt;-<span class="st"> </span>daily <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">wday2 =</span>
      <span class="kw">case_when</span>(
        wday <span class="op">==</span><span class="st"> &quot;Sat&quot;</span> <span class="op">&amp;</span><span class="st"> </span>term <span class="op">==</span><span class="st"> &quot;summer&quot;</span> <span class="op">~</span><span class="st"> &quot;Sat-summer&quot;</span>,
        wday <span class="op">==</span><span class="st"> &quot;Sat&quot;</span> <span class="op">&amp;</span><span class="st"> </span>term <span class="op">==</span><span class="st"> &quot;fall&quot;</span> <span class="op">~</span><span class="st"> &quot;Sat-fall&quot;</span>,
        wday <span class="op">==</span><span class="st"> &quot;Sat&quot;</span> <span class="op">&amp;</span><span class="st"> </span>term <span class="op">==</span><span class="st"> &quot;spring&quot;</span> <span class="op">~</span><span class="st"> &quot;Sat-spring&quot;</span>,
        <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.character</span>(wday)
      )
  )</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">mod3 &lt;-<span class="st"> </span><span class="kw">lm</span>(n <span class="op">~</span><span class="st"> </span>wday2, <span class="dt">data =</span> daily)

daily <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gather_residuals</span>(<span class="dt">sat_term =</span> mod3, <span class="dt">all_interact =</span> mod2) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(date, resid, <span class="dt">colour =</span> model)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">alpha =</span> <span class="fl">0.75</span>)</code></pre>
<p><img src="model-building_files/figure-html/unnamed-chunk-16-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>I think the overlapping plot is hard to understand.
If we are interested in the differences, it is better to plot the differences directly.
In this code, I use <code>spread_residuals()</code> to add one <em>column</em> per model, rather than <code>gather_residuals()</code> which creates a new row for each model.</p>
<pre class="sourceCode r"><code class="sourceCode r">daily <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">spread_residuals</span>(<span class="dt">sat_term =</span> mod3, <span class="dt">all_interact =</span> mod2) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">resid_diff =</span> sat_term <span class="op">-</span><span class="st"> </span>all_interact) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(date, resid_diff)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">alpha =</span> <span class="fl">0.75</span>)</code></pre>
<p><img src="model-building_files/figure-html/unnamed-chunk-17-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>The model with terms × Saturday has higher residuals in the fall and lower residuals in the spring than the model with all interactions.</p>
<p>Using overall model comparison terms, <code>mod4</code> has a lower <span class="math inline">\(R^2\)</span> and regression standard error, <span class="math inline">\(\hat{\sigma}\)</span>, despite using fewer variables.
More importantly for prediction purposes, this model has a higher AIC, which is an estimate of the out of sample error.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">glance</span>(mod3) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(r.squared, sigma, AIC, df)
<span class="co">#&gt; # A tibble: 1 x 4</span>
<span class="co">#&gt;   r.squared sigma   AIC    df</span>
<span class="co">#&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;</span>
<span class="co">#&gt; 1     0.736  47.4 3863.     9</span></code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">glance</span>(mod2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(r.squared, sigma, AIC, df)
<span class="co">#&gt; # A tibble: 1 x 4</span>
<span class="co">#&gt;   r.squared sigma   AIC    df</span>
<span class="co">#&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;</span>
<span class="co">#&gt; 1     0.757  46.2 3856.    21</span></code></pre>
</div>
</div>
<div id="exercise-24.3.4" class="section level3 unnumbered exercise">
<h3>Exercise <span class="exercise-number">24.3.4</span></h3>
<div class="question">
<p>Create a new <code>wday</code> variable that combines the day of week, term (for Saturdays), and public holidays.
What do the residuals of that model look like?</p>
</div>
<div class="answer">
<p>The question is unclear how to handle public holidays. There are several questions to consider.</p>
<p>First, what are the public holidays? I include all <a href="https://en.wikipedia.org/wiki/Federal_holidays_in_the_United_States">federal holidays in the United States</a> in 2013.
Other holidays to consider would be Easter and Good Friday which is US stock market holiday and widely celebrated religious holiday, Mothers Day, Fathers Day,
and Patriots’ Day, which is a holiday in several states, and other state holidays.</p>
<pre class="sourceCode r"><code class="sourceCode r">holidays_<span class="dv">2013</span> &lt;-
<span class="st">  </span><span class="kw">tribble</span>(
    <span class="op">~</span>holiday, <span class="op">~</span>date,
    <span class="st">&quot;New Year&#39;s Day&quot;</span>, <span class="dv">20130101</span>,
    <span class="st">&quot;Martin Luther King Jr. Day&quot;</span>, <span class="dv">20130121</span>,
    <span class="st">&quot;Washington&#39;s Birthday&quot;</span>, <span class="dv">20130218</span>,
    <span class="st">&quot;Memorial Day&quot;</span>, <span class="dv">20130527</span>,
    <span class="st">&quot;Independence Day&quot;</span>, <span class="dv">20130704</span>,
    <span class="st">&quot;Labor Day&quot;</span>, <span class="dv">20130902</span>,
    <span class="st">&quot;Columbus Day&quot;</span>, <span class="dv">20131028</span>,
    <span class="st">&quot;Veteran&#39;s Day&quot;</span>, <span class="dv">20131111</span>,
    <span class="st">&quot;Thanksgiving&quot;</span>, <span class="dv">20131128</span>,
    <span class="st">&quot;Christmas&quot;</span>, <span class="dv">20131225</span>
  ) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">date =</span> lubridate<span class="op">::</span><span class="kw">ymd</span>(date))</code></pre>
<p>The model could include a single dummy variable which indicates a day was a public holiday.
Alternatively, I could include a dummy variable for each public holiday.
I would expect that Veteran’s Day and Washington’s Birthday have a different effect on travel than Thanksgiving, Christmas, and New Year’s Day.</p>
<p>Another question is whether and how I should handle the days before and after holidays.
Travel could be lighter on the day of the holiday,
but heavier the day before or after.</p>
<pre class="sourceCode r"><code class="sourceCode r">daily &lt;-<span class="st"> </span>daily <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">wday3 =</span>
      <span class="kw">case_when</span>(
        (date <span class="op">-</span><span class="st"> </span>1L) <span class="op">%in%</span><span class="st"> </span>holidays_<span class="dv">2013</span><span class="op">$</span>date <span class="op">~</span><span class="st"> &quot;day before holiday&quot;</span>,
        (date <span class="op">+</span><span class="st"> </span>1L) <span class="op">%in%</span><span class="st"> </span>holidays_<span class="dv">2013</span><span class="op">$</span>date <span class="op">~</span><span class="st"> &quot;day after holiday&quot;</span>,
        date <span class="op">%in%</span><span class="st"> </span>holidays_<span class="dv">2013</span><span class="op">$</span>date <span class="op">~</span><span class="st"> &quot;holiday&quot;</span>,
        .<span class="op">$</span>wday <span class="op">==</span><span class="st"> &quot;Sat&quot;</span> <span class="op">&amp;</span><span class="st"> </span>.<span class="op">$</span>term <span class="op">==</span><span class="st"> &quot;summer&quot;</span> <span class="op">~</span><span class="st"> &quot;Sat-summer&quot;</span>,
        .<span class="op">$</span>wday <span class="op">==</span><span class="st"> &quot;Sat&quot;</span> <span class="op">&amp;</span><span class="st"> </span>.<span class="op">$</span>term <span class="op">==</span><span class="st"> &quot;fall&quot;</span> <span class="op">~</span><span class="st"> &quot;Sat-fall&quot;</span>,
        .<span class="op">$</span>wday <span class="op">==</span><span class="st"> &quot;Sat&quot;</span> <span class="op">&amp;</span><span class="st"> </span>.<span class="op">$</span>term <span class="op">==</span><span class="st"> &quot;spring&quot;</span> <span class="op">~</span><span class="st"> &quot;Sat-spring&quot;</span>,
        <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.character</span>(.<span class="op">$</span>wday)
      )
  )

mod4 &lt;-<span class="st"> </span><span class="kw">lm</span>(n <span class="op">~</span><span class="st"> </span>wday3, <span class="dt">data =</span> daily)

daily <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">spread_residuals</span>(<span class="dt">resid_sat_terms =</span> mod3, <span class="dt">resid_holidays =</span> mod4) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">resid_diff =</span> resid_holidays <span class="op">-</span><span class="st"> </span>resid_sat_terms) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(date, resid_diff)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">alpha =</span> <span class="fl">0.75</span>)</code></pre>
<p><img src="model-building_files/figure-html/unnamed-chunk-21-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="exercise-24.3.5" class="section level3 unnumbered exercise">
<h3>Exercise <span class="exercise-number">24.3.5</span></h3>
<div class="question">
<p>What happens if you fit a day of week effect that varies by month (i.e., <code>n ~ wday * month</code>)?
Why is this not very helpful?</p>
</div>
<div class="answer">
<pre class="sourceCode r"><code class="sourceCode r">daily &lt;-<span class="st"> </span><span class="kw">mutate</span>(daily, <span class="dt">month =</span> <span class="kw">factor</span>(lubridate<span class="op">::</span><span class="kw">month</span>(date)))
mod6 &lt;-<span class="st"> </span><span class="kw">lm</span>(n <span class="op">~</span><span class="st"> </span>wday <span class="op">*</span><span class="st"> </span>month, <span class="dt">data =</span> daily)
<span class="kw">print</span>(<span class="kw">summary</span>(mod6))
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = n ~ wday * month, data = daily)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residuals:</span>
<span class="co">#&gt;    Min     1Q Median     3Q    Max </span>
<span class="co">#&gt; -269.2   -5.0    1.5    8.8  113.2 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;                Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="co">#&gt; (Intercept)     867.400      7.598  114.16  &lt; 2e-16 ***</span>
<span class="co">#&gt; wday.L          -64.074     20.874   -3.07  0.00235 ** </span>
<span class="co">#&gt; wday.Q         -165.600     20.156   -8.22  7.8e-15 ***</span>
<span class="co">#&gt; wday.C          -68.259     20.312   -3.36  0.00089 ***</span>
<span class="co">#&gt; wday^4          -92.081     20.499   -4.49  1.0e-05 ***</span>
<span class="co">#&gt; wday^5            9.793     19.733    0.50  0.62011    </span>
<span class="co">#&gt; wday^6          -20.438     18.992   -1.08  0.28280    </span>
<span class="co">#&gt; month2           23.707     10.995    2.16  0.03191 *  </span>
<span class="co">#&gt; month3           67.886     10.746    6.32  1.0e-09 ***</span>
<span class="co">#&gt; month4           74.593     10.829    6.89  3.7e-11 ***</span>
<span class="co">#&gt; month5           56.279     10.746    5.24  3.2e-07 ***</span>
<span class="co">#&gt; month6           80.307     10.829    7.42  1.4e-12 ***</span>
<span class="co">#&gt; month7           77.114     10.746    7.18  6.4e-12 ***</span>
<span class="co">#&gt; month8           81.636     10.746    7.60  4.5e-13 ***</span>
<span class="co">#&gt; month9           51.371     10.829    4.74  3.3e-06 ***</span>
<span class="co">#&gt; month10          60.136     10.746    5.60  5.2e-08 ***</span>
<span class="co">#&gt; month11          46.914     10.829    4.33  2.1e-05 ***</span>
<span class="co">#&gt; month12          38.779     10.746    3.61  0.00036 ***</span>
<span class="co">#&gt; wday.L:month2    -3.723     29.627   -0.13  0.90009    </span>
<span class="co">#&gt; wday.Q:month2    -3.819     29.125   -0.13  0.89578    </span>
<span class="co">#&gt; wday.C:month2     0.490     29.233    0.02  0.98664    </span>
<span class="co">#&gt; wday^4:month2     4.569     29.364    0.16  0.87646    </span>
<span class="co">#&gt; wday^5:month2    -4.255     28.835   -0.15  0.88278    </span>
<span class="co">#&gt; wday^6:month2    12.057     28.332    0.43  0.67076    </span>
<span class="co">#&gt; wday.L:month3   -14.571     28.430   -0.51  0.60870    </span>
<span class="co">#&gt; wday.Q:month3    15.439     28.207    0.55  0.58458    </span>
<span class="co">#&gt; wday.C:month3     8.226     28.467    0.29  0.77282    </span>
<span class="co">#&gt; wday^4:month3    22.720     28.702    0.79  0.42926    </span>
<span class="co">#&gt; wday^5:month3   -15.330     28.504   -0.54  0.59113    </span>
<span class="co">#&gt; wday^6:month3    11.373     28.268    0.40  0.68776    </span>
<span class="co">#&gt; wday.L:month4   -16.668     29.359   -0.57  0.57067    </span>
<span class="co">#&gt; wday.Q:month4    10.725     28.962    0.37  0.71142    </span>
<span class="co">#&gt; wday.C:month4    -0.245     28.725   -0.01  0.99320    </span>
<span class="co">#&gt; wday^4:month4    23.288     28.871    0.81  0.42056    </span>
<span class="co">#&gt; wday^5:month4   -17.872     28.076   -0.64  0.52494    </span>
<span class="co">#&gt; wday^6:month4     5.352     27.888    0.19  0.84794    </span>
<span class="co">#&gt; wday.L:month5     3.666     29.359    0.12  0.90071    </span>
<span class="co">#&gt; wday.Q:month5   -20.665     28.670   -0.72  0.47163    </span>
<span class="co">#&gt; wday.C:month5     4.634     28.725    0.16  0.87196    </span>
<span class="co">#&gt; wday^4:month5     5.999     28.511    0.21  0.83349    </span>
<span class="co">#&gt; wday^5:month5   -16.912     28.076   -0.60  0.54742    </span>
<span class="co">#&gt; wday^6:month5    12.764     27.194    0.47  0.63916    </span>
<span class="co">#&gt; wday.L:month6    -4.526     28.651   -0.16  0.87459    </span>
<span class="co">#&gt; wday.Q:month6    23.813     28.207    0.84  0.39927    </span>
<span class="co">#&gt; wday.C:month6    13.758     28.725    0.48  0.63234    </span>
<span class="co">#&gt; wday^4:month6    24.118     29.187    0.83  0.40932    </span>
<span class="co">#&gt; wday^5:month6   -17.648     28.798   -0.61  0.54048    </span>
<span class="co">#&gt; wday^6:month6    10.526     28.329    0.37  0.71051    </span>
<span class="co">#&gt; wday.L:month7   -28.791     29.359   -0.98  0.32760    </span>
<span class="co">#&gt; wday.Q:month7    49.585     28.670    1.73  0.08482 .  </span>
<span class="co">#&gt; wday.C:month7    54.501     28.725    1.90  0.05881 .  </span>
<span class="co">#&gt; wday^4:month7    50.847     28.511    1.78  0.07559 .  </span>
<span class="co">#&gt; wday^5:month7   -33.698     28.076   -1.20  0.23106    </span>
<span class="co">#&gt; wday^6:month7   -13.894     27.194   -0.51  0.60979    </span>
<span class="co">#&gt; wday.L:month8   -20.448     28.871   -0.71  0.47938    </span>
<span class="co">#&gt; wday.Q:month8     6.765     28.504    0.24  0.81258    </span>
<span class="co">#&gt; wday.C:month8     6.001     28.467    0.21  0.83319    </span>
<span class="co">#&gt; wday^4:month8    19.074     28.781    0.66  0.50806    </span>
<span class="co">#&gt; wday^5:month8   -19.312     28.058   -0.69  0.49183    </span>
<span class="co">#&gt; wday^6:month8     9.507     27.887    0.34  0.73341    </span>
<span class="co">#&gt; wday.L:month9   -30.341     28.926   -1.05  0.29511    </span>
<span class="co">#&gt; wday.Q:month9   -42.034     28.670   -1.47  0.14373    </span>
<span class="co">#&gt; wday.C:month9   -20.719     28.725   -0.72  0.47134    </span>
<span class="co">#&gt; wday^4:month9   -20.375     28.791   -0.71  0.47973    </span>
<span class="co">#&gt; wday^5:month9   -18.238     28.523   -0.64  0.52308    </span>
<span class="co">#&gt; wday^6:month9    11.726     28.270    0.41  0.67861    </span>
<span class="co">#&gt; wday.L:month10  -61.051     29.520   -2.07  0.03954 *  </span>
<span class="co">#&gt; wday.Q:month10  -26.235     28.504   -0.92  0.35815    </span>
<span class="co">#&gt; wday.C:month10  -32.435     28.725   -1.13  0.25979    </span>
<span class="co">#&gt; wday^4:month10  -12.212     28.990   -0.42  0.67389    </span>
<span class="co">#&gt; wday^5:month10  -27.686     27.907   -0.99  0.32201    </span>
<span class="co">#&gt; wday^6:month10    0.123     26.859    0.00  0.99634    </span>
<span class="co">#&gt; wday.L:month11  -54.947     28.926   -1.90  0.05851 .  </span>
<span class="co">#&gt; wday.Q:month11   16.012     28.670    0.56  0.57696    </span>
<span class="co">#&gt; wday.C:month11   54.950     28.725    1.91  0.05677 .  </span>
<span class="co">#&gt; wday^4:month11   47.286     28.791    1.64  0.10164    </span>
<span class="co">#&gt; wday^5:month11  -44.740     28.523   -1.57  0.11787    </span>
<span class="co">#&gt; wday^6:month11  -20.688     28.270   -0.73  0.46491    </span>
<span class="co">#&gt; wday.L:month12   -9.506     28.871   -0.33  0.74221    </span>
<span class="co">#&gt; wday.Q:month12   75.209     28.504    2.64  0.00879 ** </span>
<span class="co">#&gt; wday.C:month12  -25.026     28.467   -0.88  0.38010    </span>
<span class="co">#&gt; wday^4:month12  -23.780     28.781   -0.83  0.40938    </span>
<span class="co">#&gt; wday^5:month12   20.447     28.058    0.73  0.46676    </span>
<span class="co">#&gt; wday^6:month12    9.586     27.887    0.34  0.73128    </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residual standard error: 42 on 281 degrees of freedom</span>
<span class="co">#&gt; Multiple R-squared:  0.836,  Adjusted R-squared:  0.787 </span>
<span class="co">#&gt; F-statistic: 17.2 on 83 and 281 DF,  p-value: &lt;2e-16</span></code></pre>
<p>If we fit a day of week effect that varies by month, there will be <code>12 * 7 = 84</code> parameters in the model.
Since each month has only four to five weeks, each of these day of week <span class="math inline">\(\times\)</span> month effects is the average of only four or five observations.
These estimates have large standard errors and likely not generalize well beyond the sample data, since they are estimated from only a few observations.</p>
</div>
</div>
<div id="exercise-24.3.6" class="section level3 unnumbered exercise">
<h3>Exercise <span class="exercise-number">24.3.6</span></h3>
<div class="question">
<p>What would you expect the model <code>n ~ wday + ns(date, 5)</code> to look like?
Knowing what you know about the data, why would you expect it to be not particularly effective?</p>
</div>
<div class="answer">
<p>Previous models fit in the chapter and exercises show that the effects of days of the week vary across different times of the year.
The model <code>wday + ns(date, 5)</code> does not interact the day of week effect (<code>wday</code>) with the time of year effects (<code>ns(date, 5)</code>).</p>
<p>I estimate a model which does not interact the day of week effects (<code>mod7</code>) with the spline to that which does (<code>mod8</code>).
I need to load the <strong>splines</strong> package to use the <code>ns()</code> function.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;splines&quot;</span>)
mod7 &lt;-<span class="st"> </span><span class="kw">lm</span>(n <span class="op">~</span><span class="st"> </span>wday <span class="op">+</span><span class="st"> </span><span class="kw">ns</span>(date, <span class="dv">5</span>), <span class="dt">data =</span> daily)
mod8 &lt;-<span class="st"> </span><span class="kw">lm</span>(n <span class="op">~</span><span class="st"> </span>wday <span class="op">*</span><span class="st"> </span><span class="kw">ns</span>(date, <span class="dv">5</span>), <span class="dt">data =</span> daily)</code></pre>
<p>The residuals of the model that does not interact day of week with time of year (<code>mod7</code>) are larger than those of the model that does (<code>mod8</code>).
The model <code>mod7</code> underestimates weekends during the summer and overestimates weekends during the autumn.</p>
<pre class="sourceCode r"><code class="sourceCode r">daily <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gather_residuals</span>(mod7, mod8) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> date, <span class="dt">y =</span> resid, <span class="dt">color =</span> model)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">alpha =</span> <span class="fl">0.75</span>)</code></pre>
<p><img src="model-building_files/figure-html/unnamed-chunk-24-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="exercise-24.3.7" class="section level3 unnumbered exercise">
<h3>Exercise <span class="exercise-number">24.3.7</span></h3>
<div class="question">
<p>We hypothesized that people leaving on Sundays are more likely to be business travelers who need to be somewhere on Monday.
Explore that hypothesis by seeing how it breaks down based on distance and time:
if it’s true, you’d expect to see more Sunday evening flights to places that are far away.</p>
</div>
<div class="answer">
<p>Comparing the average distances of flights by day of week, Sunday flights are the second longest.
Saturday flights are the longest on average.
Saturday may have the longest flights on average because there are fewer regularly scheduled short business/commuter flights on the weekends but that is speculation.</p>
<pre class="sourceCode r"><code class="sourceCode r">flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">date =</span> <span class="kw">make_date</span>(year, month, day),
    <span class="dt">wday =</span> <span class="kw">wday</span>(date, <span class="dt">label =</span> <span class="ot">TRUE</span>)
  ) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> distance, <span class="dt">x =</span> wday)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Day of Week&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Average Distance&quot;</span>)</code></pre>
<p><img src="model-building_files/figure-html/unnamed-chunk-25-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Hide outliers.</p>
<pre class="sourceCode r"><code class="sourceCode r">flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">date =</span> <span class="kw">make_date</span>(year, month, day),
    <span class="dt">wday =</span> <span class="kw">wday</span>(date, <span class="dt">label =</span> <span class="ot">TRUE</span>)
  ) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> distance, <span class="dt">x =</span> wday)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">outlier.shape =</span> <span class="ot">NA</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Day of Week&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Average Distance&quot;</span>)</code></pre>
<p><img src="model-building_files/figure-html/unnamed-chunk-26-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Try pointrange with mean and standard error of the mean (sd / sqrt(n)).</p>
<pre class="sourceCode r"><code class="sourceCode r">flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">date =</span> <span class="kw">make_date</span>(year, month, day),
    <span class="dt">wday =</span> <span class="kw">wday</span>(date, <span class="dt">label =</span> <span class="ot">TRUE</span>)
  ) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> distance, <span class="dt">x =</span> wday)) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_summary</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Day of Week&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Average Distance&quot;</span>)
<span class="co">#&gt; No summary function supplied, defaulting to `mean_se()</span></code></pre>
<p><img src="model-building_files/figure-html/unnamed-chunk-27-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Try pointrange with mean and standard error of the mean (sd / sqrt(n)).</p>
<pre class="sourceCode r"><code class="sourceCode r">flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">date =</span> <span class="kw">make_date</span>(year, month, day),
    <span class="dt">wday =</span> <span class="kw">wday</span>(date, <span class="dt">label =</span> <span class="ot">TRUE</span>)
  ) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> distance, <span class="dt">x =</span> wday)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_violin</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Day of Week&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Average Distance&quot;</span>)</code></pre>
<p><img src="model-building_files/figure-html/unnamed-chunk-28-1.png" width="70%" style="display: block; margin: auto;" /></p>
<pre class="sourceCode r"><code class="sourceCode r">flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">date =</span> <span class="kw">make_date</span>(year, month, day),
    <span class="dt">wday =</span> <span class="kw">wday</span>(date, <span class="dt">label =</span> <span class="ot">TRUE</span>)
  ) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(
    distance <span class="op">&lt;</span><span class="st"> </span><span class="dv">3000</span>,
    hour <span class="op">&gt;=</span><span class="st"> </span><span class="dv">5</span>, hour <span class="op">&lt;=</span><span class="st"> </span><span class="dv">21</span>
  ) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> hour, <span class="dt">color =</span> wday, <span class="dt">y =</span> ..density..)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_freqpoly</span>(<span class="dt">binwidth =</span> <span class="dv">1</span>)</code></pre>
<p><img src="model-building_files/figure-html/unnamed-chunk-29-1.png" width="70%" style="display: block; margin: auto;" /></p>
<pre class="sourceCode r"><code class="sourceCode r">flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">date =</span> <span class="kw">make_date</span>(year, month, day),
    <span class="dt">wday =</span> <span class="kw">wday</span>(date, <span class="dt">label =</span> <span class="ot">TRUE</span>)
  ) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(
    distance <span class="op">&lt;</span><span class="st"> </span><span class="dv">3000</span>,
    hour <span class="op">&gt;=</span><span class="st"> </span><span class="dv">5</span>, hour <span class="op">&lt;=</span><span class="st"> </span><span class="dv">21</span>
  ) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(wday, hour) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">distance =</span> <span class="kw">mean</span>(distance)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> hour, <span class="dt">color =</span> wday, <span class="dt">y =</span> distance)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>()</code></pre>
<p><img src="model-building_files/figure-html/unnamed-chunk-30-1.png" width="70%" style="display: block; margin: auto;" /></p>
<pre class="sourceCode r"><code class="sourceCode r">flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">date =</span> <span class="kw">make_date</span>(year, month, day),
    <span class="dt">wday =</span> <span class="kw">wday</span>(date, <span class="dt">label =</span> <span class="ot">TRUE</span>)
  ) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(
    distance <span class="op">&lt;</span><span class="st"> </span><span class="dv">3000</span>,
    hour <span class="op">&gt;=</span><span class="st"> </span><span class="dv">5</span>, hour <span class="op">&lt;=</span><span class="st"> </span><span class="dv">21</span>
  ) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(wday, hour) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">distance =</span> <span class="kw">sum</span>(distance)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(wday) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prop_distance =</span> distance <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(distance)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> hour, <span class="dt">color =</span> wday, <span class="dt">y =</span> prop_distance)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>()</code></pre>
<p><img src="model-building_files/figure-html/unnamed-chunk-31-1.png" width="70%" style="display: block; margin: auto;" /></p>
<!--
|time of day    | start time | end time |
|:--------------|:-----------|:---------|
| Early morning | 12 am      |    5 am  |
| Morning       | 5 am       |    12 pm |
| Afternoon     | 12 pm      |    6 pm  |
| Evening       | 6 pm       |    12 pm |


```r
flights %>%
  mutate(
    date = make_date(year, month, day),
    wday = wday(date, label = TRUE),
    time = factor(case_when(
      hour < 5 ~ "Early morning",
      hour < 12 ~ "Morning",
      hour < 18 ~ "Afternoon",
      TRUE ~ "Evening"
    ),
    levels = c(
      "Early morning", "Morning",
      "Afternoon", "Evening"
    )
    )
  ) %>%
  group_by(wday, time) %>%
  filter(time != "Early morning") %>%
  summarise(distance = mean(distance)) %>%
  ggplot(aes(color = wday, y = distance, x = time)) +
  geom_point()
```

<img src="model-building_files/figure-html/unnamed-chunk-32-1.png" width="70%" style="display: block; margin: auto;" />
-->
</div>
</div>
<div id="exercise-24.3.8" class="section level3 unnumbered exercise">
<h3>Exercise <span class="exercise-number">24.3.8</span></h3>
<div class="question">
<p>It’s a little frustrating that Sunday and Saturday are on separate ends of the plot.
Write a small function to set the levels of the factor so that the week starts on Monday.</p>
</div>
<div class="answer">
<p>See the chapter <a href="http://r4ds.had.co.nz/factors.html">Factors</a> for the function <code>fct_relevel()</code>.
Use <code>fct_relevel()</code> to put all levels in-front of the first level (“Sunday”).</p>
<pre class="sourceCode r"><code class="sourceCode r">monday_first &lt;-<span class="st"> </span><span class="cf">function</span>(x) {
  forcats<span class="op">::</span><span class="kw">fct_relevel</span>(x, <span class="kw">levels</span>(x)[<span class="op">-</span><span class="dv">1</span>])
}</code></pre>
<p>Now Monday is the first day of the week.</p>
<pre class="sourceCode r"><code class="sourceCode r">daily &lt;-<span class="st"> </span>daily <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">wday =</span> <span class="kw">wday</span>(date, <span class="dt">label =</span> <span class="ot">TRUE</span>))
<span class="kw">ggplot</span>(daily, <span class="kw">aes</span>(<span class="kw">monday_first</span>(wday), n)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Day of Week&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Number of flights&quot;</span>)</code></pre>
<p><img src="model-building_files/figure-html/unnamed-chunk-34-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
<div id="learning-more-about-models" class="section level2">
<h2><span class="header-section-number">24.4</span> Learning more about models</h2>
<div class="alert alert-warning hints-alert">
<div class="hints-icon">
<i class="fa fa-exclamation-circle"></i>
</div>
<div class="hints-container">No exercises</div>
</div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="model-basics.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="many-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": true,
"google": false,
"linkedin": true,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper", "vk"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jrnold/r4ds-exercise-solutions/edit/master/model-building.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
